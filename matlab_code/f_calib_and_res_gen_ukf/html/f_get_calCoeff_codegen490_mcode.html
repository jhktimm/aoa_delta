<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="101,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T3U3">calCoeff</span>] = f_get_calCoeff_codegen(<span class="var type1" id="S3T4U6">Probe_Ampl</span>,<span class="var type1" id="S4T4U7">Probe_Phase</span>, <span class="var type1" id="S5T4U8">Forw_Ampl</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,2" id="srcline2"> 2</a></span><span class="line">    <span class="var type1" id="S6T4U9">Forw_Phase</span>, <span class="var type1" id="S7T4U10">Refl_Ampl</span>, <span class="var type1" id="S8T4U11">Refl_Probe</span>, <span class="var type1" id="S9T5U12">DELAY</span>, <span class="var type1" id="S10T5U13">FILLING</span>, <span class="var type1" id="S11T5U14">FLATTOP</span>, <span class="var type1" id="S12T5U15">FS</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="101,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% claCoeff = f_get_calCoeff returns a 4 dimensional vector containing the</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% coefficients needed for the calibration of the forward and reflected</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% signals with respect to the probe. To calibrate a new set of data from</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% the same cavity use f_calibrate().</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% Input Parameters:</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% Probe_Ampl: Amplitude of Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Probe_Phase: Phase of Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,10" id="srcline10">10</a></span><span class="line"><span class="comment">% Forw_Ampl: Amplitude of Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,11" id="srcline11">11</a></span><span class="line"><span class="comment">% Forw_Phase: Phase of Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,12" id="srcline12">12</a></span><span class="line"><span class="comment">% Refl_Ampl: Amplitude of Reflected measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,13" id="srcline13">13</a></span><span class="line"><span class="comment">% Refl_Probe: Phase of Reflected measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,14" id="srcline14">14</a></span><span class="line"><span class="comment">% DECAY_TIM: Array containing the sample numbers that correspond to the</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,15" id="srcline15">15</a></span><span class="line"><span class="comment">% duration of the decay time.</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,16" id="srcline16">16</a></span><span class="line"><span class="comment">%% free parameters<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,17" id="srcline17">17</a></span><span class="line"><span class="comment">% #codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T5:U12"><span class="var type1" id="S13T5U18">fs</span> = <span class="mxinfo " id="T5:U14"><span class="var type1" id="S12T5U20">FS</span>*<span class="mxinfo " id="T5:U16">1e6</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,19" id="srcline19">19</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U17"><span class="var type1" id="S13T5U25">fs</span> ==<span class="mxinfo " id="T5:U19">1e6</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T21:U20"><span class="var type1" id="S14T21U29">Rise</span> = <span class="mxinfo " id="T21:U22"><span class="mxinfo " id="T5:U23">round(<span class="mxinfo " id="T5:U24"><span class="mxinfo " id="T5:U25"><span class="var type1" id="S9T5U35">DELAY</span> * <span class="var type1" id="S13T5U36">fs</span></span> *<span class="mxinfo " id="T5:U28">1e-6</span></span>)</span>:<span class="mxinfo " id="T5:U29">round(<span class="mxinfo " id="T5:U30"><span class="mxinfo " id="T5:U31"><span class="mxinfo " id="T5:U32"><span class="var type1" id="S9T5U43">DELAY</span> * <span class="var type1" id="S13T5U44">fs</span></span>*<span class="mxinfo " id="T5:U35">1e-6</span></span>+ <span class="mxinfo " id="T5:U36"><span class="mxinfo " id="T5:U37"><span class="var type1" id="S10T5U48">FILLING</span>*<span class="var type1" id="S13T5U49">fs</span></span>*<span class="mxinfo " id="T5:U40">1e-6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo " id="T21:U41"><span class="var type1" id="S16T21U53">Flattop</span> = <span class="mxinfo " id="T21:U43"><span class="mxinfo " id="T5:U44"><span class="mxinfo " id="T5:U45"><span class="var type1" id="S14T21U57">Rise</span>(<span class="mxinfo " id="T5:U47">end</span>)</span>+<span class="mxinfo " id="T5:U48">1</span></span> : <span class="mxinfo " id="T5:U49"><span class="mxinfo " id="T5:U50"><span class="mxinfo " id="T5:U51"><span class="var type1" id="S14T21U64">Rise</span>(<span class="mxinfo " id="T5:U53">end</span>)</span>+<span class="mxinfo " id="T5:U54">1</span></span>+<span class="mxinfo " id="T5:U55">round(<span class="mxinfo " id="T5:U56"><span class="mxinfo " id="T5:U57"><span class="var type1" id="S11T5U72">FLATTOP</span>*<span class="var type1" id="S13T5U73">fs</span></span>*<span class="mxinfo " id="T5:U60">1e-6</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T21:U61"><span class="var type1" id="S18T21U77">Decay</span> = <span class="mxinfo " id="T21:U63"><span class="mxinfo " id="T5:U64"><span class="mxinfo " id="T5:U65"><span class="var type1" id="S16T21U81">Flattop</span>(<span class="mxinfo " id="T5:U67">end</span>)</span>+<span class="mxinfo " id="T5:U68">1</span></span> : round(2^(14)/9+1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T21:U69"><span class="var type1" id="S19T21U97">DECAY_TIME</span> = <span class="mxinfo " id="T21:U71"><span class="mxinfo " id="T5:U72"><span class="mxinfo " id="T5:U73"><span class="var type1" id="S18T21U101">Decay</span>(<span class="mxinfo " id="T5:U75">1</span>)</span>+<span class="mxinfo " id="T5:U76">round(<span class="mxinfo " id="T5:U77">3000/9</span>)</span></span>:<span class="mxinfo " id="T5:U78"><span class="var type1" id="S18T21U109">Decay</span>(<span class="mxinfo " id="T5:U80"><span class="mxinfo " id="T5:U81">end</span>-<span class="mxinfo " id="T5:U82">1</span></span>)</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="101,24" id="srcline24">24</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo " id="T21:U83"><span class="var type1" id="S14T21U117">Rise</span> = <span class="mxinfo " id="T21:U85"><span class="mxinfo " id="T5:U86">round(<span class="mxinfo " id="T5:U87"><span class="mxinfo " id="T5:U88"><span class="var type1" id="S9T5U123">DELAY</span> * <span class="var type1" id="S13T5U124">fs</span></span> *<span class="mxinfo " id="T5:U91">1e-6</span></span>)</span>:<span class="mxinfo " id="T5:U92">round(<span class="mxinfo " id="T5:U93"><span class="mxinfo " id="T5:U94"><span class="mxinfo " id="T5:U95"><span class="var type1" id="S9T5U131">DELAY</span> * <span class="var type1" id="S13T5U132">fs</span></span>*<span class="mxinfo " id="T5:U98">1e-6</span></span>+ <span class="mxinfo " id="T5:U99"><span class="mxinfo " id="T5:U100"><span class="var type1" id="S10T5U136">FILLING</span>*<span class="var type1" id="S13T5U137">fs</span></span>*<span class="mxinfo " id="T5:U103">1e-6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T21:U104"><span class="var type1" id="S16T21U141">Flattop</span> = <span class="mxinfo " id="T21:U106"><span class="mxinfo " id="T5:U107"><span class="mxinfo " id="T5:U108"><span class="var type1" id="S14T21U145">Rise</span>(<span class="mxinfo " id="T5:U110">end</span>)</span>+<span class="mxinfo " id="T5:U111">1</span></span> : <span class="mxinfo " id="T5:U112"><span class="mxinfo " id="T5:U113"><span class="mxinfo " id="T5:U114"><span class="var type1" id="S14T21U152">Rise</span>(<span class="mxinfo " id="T5:U116">end</span>)</span>+<span class="mxinfo " id="T5:U117">1</span></span>+<span class="mxinfo " id="T5:U118">round(<span class="mxinfo " id="T5:U119"><span class="mxinfo " id="T5:U120"><span class="var type1" id="S11T5U160">FLATTOP</span>*<span class="var type1" id="S13T5U161">fs</span></span>*<span class="mxinfo " id="T5:U123">1e-6</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T21:U124"><span class="var type1" id="S18T21U165">Decay</span> = <span class="mxinfo " id="T21:U126"><span class="mxinfo " id="T5:U127"><span class="mxinfo " id="T5:U128"><span class="var type1" id="S16T21U169">Flattop</span>(<span class="mxinfo " id="T5:U130">end</span>)</span>+<span class="mxinfo " id="T5:U131">1</span></span> : 2^(14)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T21:U132"><span class="var type1" id="S19T21U179">DECAY_TIME</span> = <span class="mxinfo " id="T21:U134"><span class="mxinfo " id="T5:U135"><span class="mxinfo " id="T5:U136"><span class="var type1" id="S18T21U183">Decay</span>(<span class="mxinfo " id="T5:U138">1</span>)</span>+<span class="mxinfo " id="T5:U139">3000</span></span>:<span class="mxinfo " id="T5:U140"><span class="var type1" id="S18T21U187">Decay</span>(<span class="mxinfo " id="T5:U142">end</span>)</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="101,29" id="srcline29">29</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T29:U143"><span class="var type1" id="S20T29U192">y_mC</span> = <span class="mxinfo " id="T29:U145"><span class="var type1" id="S3T4U194">Probe_Ampl</span>.*<span class="mxinfo " id="T29:U147">exp(<span class="mxinfo " id="T29:U148"><span class="mxinfo " id="T29:U149"><span class="mxinfo " id="T29:U150"><span class="mxinfo " id="T28:U151">1i</span>*<span class="var type1" id="S4T4U201">Probe_Phase</span></span>/180</span>*<span class="mxinfo " id="T5:U153">pi</span></span>)</span></span></span>; <span class="comment">% Complex Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo " id="T29:U154"><span class="var type1" id="S23T29U207">u_mC</span> = <span class="mxinfo " id="T29:U156"><span class="var type1" id="S5T4U209">Forw_Ampl</span>.*<span class="mxinfo " id="T29:U158">exp(<span class="mxinfo " id="T29:U159"><span class="mxinfo " id="T29:U160"><span class="mxinfo " id="T29:U161"><span class="mxinfo " id="T28:U162">1i</span>*<span class="var type1" id="S6T4U216">Forw_Phase</span></span>/180</span>*<span class="mxinfo " id="T5:U164">pi</span></span>)</span></span></span>; <span class="comment">% Complex Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T29:U165"><span class="var type1" id="S24T29U222">r_mC</span> = <span class="mxinfo " id="T29:U167"><span class="var type1" id="S7T4U224">Refl_Ampl</span>.*<span class="mxinfo " id="T29:U169">exp(<span class="mxinfo " id="T29:U170"><span class="mxinfo " id="T29:U171"><span class="mxinfo " id="T29:U172"><span class="mxinfo " id="T28:U173">1i</span>*<span class="var type1" id="S8T4U231">Refl_Probe</span></span>/180</span>*<span class="mxinfo " id="T5:U175">pi</span></span>)</span></span></span>; <span class="comment">% Reflected</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T3:U176"><span class="var type1" id="S2T3U237">calCoeff</span> = <span class="mxinfo " id="T3:U178"><span class="mxinfo " id="T6:U179">zeros(<span class="mxinfo " id="T5:U180">4</span>,1)</span>+<span class="mxinfo " id="T3:U181"><span class="mxinfo " id="T28:U182">1i</span>*<span class="mxinfo " id="T6:U183">zeros(<span class="mxinfo " id="T5:U184">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T3:U185"><span class="var type1" id="S26T3U251">calCoeff0</span> = <span class="mxinfo " id="T3:U187"><span class="mxinfo " id="T6:U188">zeros(<span class="mxinfo " id="T5:U189">4</span>,1)</span>+<span class="mxinfo " id="T3:U190"><span class="mxinfo " id="T28:U191">1i</span>*<span class="mxinfo " id="T6:U192">zeros(<span class="mxinfo " id="T5:U193">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T3:U194"><span class="var type1" id="S27T3U265">calCoeff1</span> = <span class="mxinfo " id="T3:U196"><span class="mxinfo " id="T6:U197">zeros(<span class="mxinfo " id="T5:U198">4</span>,1)</span>+<span class="mxinfo " id="T3:U199"><span class="mxinfo " id="T28:U200">1i</span>*<span class="mxinfo " id="T6:U201">zeros(<span class="mxinfo " id="T5:U202">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T3:U203"><span class="var type1" id="S28T3U279">calCoeff2</span> = <span class="mxinfo " id="T3:U205">zeros(<span class="mxinfo " id="T5:U206">4</span>,1)+1i*zeros(<span class="mxinfo " id="T5:U207">4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T3:U208"><span class="var type1" id="S29T3U293">calCoeff3</span> = <span class="mxinfo " id="T3:U210"><span class="mxinfo " id="T6:U211">zeros(<span class="mxinfo " id="T5:U212">4</span>,1)</span>+<span class="mxinfo " id="T3:U213"><span class="mxinfo " id="T28:U214">1i</span>*<span class="mxinfo " id="T6:U215">zeros(<span class="mxinfo " id="T5:U216">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T29:U217"><span class="var type1" id="S30T29U307">a1</span> = <span class="var type1" id="S23T29U308">u_mC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo " id="T29:U220"><span class="var type1" id="S31T29U311">a2</span> = <span class="var type1" id="S24T29U312">r_mC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo " id="T29:U223"><span class="var type1" id="S32T29U315">a3</span> = <span class="mxinfo " id="T29:U225"><span class="var type1" id="S23T29U317">u_mC</span>(<span class="var type1" id="S19T21U318">DECAY_TIME</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo " id="T29:U228"><span class="var type1" id="S33T29U321">a4</span> = <span class="mxinfo " id="T29:U230"><span class="var type1" id="S24T29U323">r_mC</span>(<span class="var type1" id="S19T21U324">DECAY_TIME</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T29:U233"><span class="var type1" id="S34T29U327">b1</span> = <span class="var type1" id="S20T29U328">y_mC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T29:U236"><span class="var type1" id="S35T29U331">b2</span> = <span class="mxinfo " id="T29:U238"><span class="var type1" id="S20T29U333">y_mC</span>(<span class="var type1" id="S19T21U334">DECAY_TIME</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,49" id="srcline49">49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,50" id="srcline50">50</a></span><span class="line"><span class="mxinfo " id="T4:U241"><span class="var type1" id="S36T4U337">zb</span> = <span class="mxinfo " id="T4:U243">zeros(<span class="mxinfo " id="T5:U244">size(<span class="var type1" id="S35T29U342">b2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,51" id="srcline51">51</a></span><span class="line"><span class="mxinfo " id="T4:U246"><span class="var type1" id="S38T4U345">za</span> = <span class="mxinfo " id="T4:U248">zeros(<span class="mxinfo " id="T5:U249">size(<span class="var type1" id="S32T29U350">a3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,52" id="srcline52">52</a></span><span class="line"><span class="comment">%za1= zeros(size(a1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,53" id="srcline53">53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo " id="T50:U251"><span class="var type1" id="S39T50U353">xystar</span> = <span class="mxinfo " id="T50:U253"><span class="mxinfo " id="T40:U254">[<span class="var type1" id="S30T29U357">a1</span> <span class="var type1" id="S31T29U358">a2</span>]</span>\<span class="var type1" id="S34T29U359">b1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,56" id="srcline56">56</a></span><span class="line"><span class="mxinfo " id="T28:U258"><span class="var type1" id="S40T28U362">xstar</span> = <span class="mxinfo " id="T28:U260"><span class="var type1" id="S39T50U364">xystar</span>(<span class="mxinfo " id="T5:U262">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo " id="T28:U263"><span class="var type1" id="S41T28U368">ystar</span> = <span class="mxinfo " id="T28:U265"><span class="var type1" id="S39T50U370">xystar</span>(<span class="mxinfo " id="T5:U267">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,58" id="srcline58">58</a></span><span class="line"><span class="comment">% estimate cross couplings next<span class="keyword">...</span><span class="comment">.</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,59" id="srcline59">59</a></span><span class="line"><span class="comment">% uses method of least squares<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo " id="T5:U268"><span class="var type1" id="S42T5U374">Wb</span> = <span class="mxinfo " id="T5:U270">0.10</span></span>; <span class="comment">% tunig factor to adjust f1/2 within pulse and during decay (Fig 21, red == yellow line)</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T5:U271"><span class="var type1" id="S43T5U378">Wc</span> = (<span class="var type1" id="S42T5U380">Wb</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,62" id="srcline62">62</a></span><span class="line"><span class="mxinfo " id="T29:U274"><span class="var type1" id="S44T29U383">Bold</span> = <span class="mxinfo " id="T29:U276">[ <span class="var type1" id="S36T4U386">zb</span> ; <span class="var type1" id="S34T29U388">b1</span> ; <span class="var type1" id="S35T29U390">b2</span> ; <span class="var type1" id="S40T28U392">xstar</span> ; <span class="var type1" id="S41T28U394">ystar</span> ; <span class="var type1" id="S41T28U396">ystar</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,63" id="srcline63">63</a></span><span class="line"><span class="mxinfo " id="T59:U283"><span class="var type1" id="S45T59U399">Aold</span> = <span class="mxinfo " id="T59:U285">[<span class="mxinfo " id="T59:U286"><span class="var type1" id="S32T29U402">a3</span>,<span class="var type1" id="S33T29U403">a4</span>,<span class="var type1" id="S38T4U404">za</span>,<span class="var type1" id="S38T4U405">za</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,64" id="srcline64">64</a></span><span class="line">    <span class="mxinfo " id="T59:U291"><span class="var type1" id="S30T29U407">a1</span>,<span class="var type1" id="S31T29U408">a2</span>,<span class="var type1" id="S30T29U409">a1</span>,<span class="var type1" id="S31T29U410">a2</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T59:U296"><span class="var type1" id="S38T4U412">za</span>,<span class="var type1" id="S38T4U413">za</span>,<span class="var type1" id="S32T29U414">a3</span>,<span class="var type1" id="S33T29U415">a4</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T70:U301"><span class="mxinfo " id="T5:U302">1</span> <span class="mxinfo " id="T5:U303">0</span> <span class="var type1" id="S43T5U419">Wc</span> <span class="mxinfo " id="T5:U305">0</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,67" id="srcline67">67</a></span><span class="line">    <span class="mxinfo " id="T70:U306"><span class="mxinfo " id="T5:U307">0</span> <span class="var type1" id="S42T5U423">Wb</span> <span class="mxinfo " id="T5:U309">0</span> <span class="mxinfo " id="T5:U310">1</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,68" id="srcline68">68</a></span><span class="line">    <span class="mxinfo " id="T70:U311"><span class="var type1" id="S43T5U427">Wc</span> <span class="mxinfo " id="T5:U313">0</span> <span class="mxinfo " id="T5:U314">0</span> <span class="mxinfo " id="T5:U315">1</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,69" id="srcline69">69</a></span><span class="line">    ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,70" id="srcline70">70</a></span><span class="line"><span class="comment">% calCoeff0(:,1) = (Aold.'*Aold)^-1*Aold.'*Bold;%mldivide(Aold,Bold); </span></span></span>
<span class="srcline"><span class="lineno"><a href="101,71" id="srcline71">71</a></span><span class="line"><span class="comment">% calCoeff1(:,1) = inv(Aold.'*Aold)*Aold.'*Bold;%mldivide(Aold,Bold); </span></span></span>
<span class="srcline"><span class="lineno"><a href="101,72" id="srcline72">72</a></span><span class="line"><span class="mxinfo " id="T3:U316"><span class="mxinfo " id="T3:U317"><span class="var type1" id="S28T3U434">calCoeff2</span>(<span class="mxinfo " id="T71:U319">:</span>,<span class="mxinfo " id="T18:U320">1</span>)</span> = <span class="mxinfo " id="T3:U321"><span class="var type1" id="S45T59U438">Aold</span>\<span class="var type1" id="S44T29U439">Bold</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,73" id="srcline73">73</a></span><span class="line"><span class="comment">% calCoeff3(:,1) = mldivide(Aold,Bold);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,74" id="srcline74">74</a></span><span class="line"><span class="mxinfo " id="T3:U324"><span class="var type1" id="S2T3U442">calCoeff</span> = <span class="var type1" id="S28T3U443">calCoeff2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,75" id="srcline75">75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,76" id="srcline76">76</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,77" id="srcline77">77</a></span><span class="line"></span></span>
</pre>
</body>
</html>
