<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="182,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T59U3">dx</span>]=f_cavitySystem(<span class="var type1" id="S3T59U6">x</span>, <span class="var type1" id="S4T7U7">u_mC</span>, <span class="var type1" id="S5T3U8">f0</span>, <span class="var type1" id="S6T3U9">fs</span>, <span class="var type1" id="S7T5U10">tau_m</span>, <span class="var type1" id="S8T5U11">K_m</span>, <span class="var type1" id="S9T3U12">QL</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="182,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%% Coupled simulink model</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T3:U9"><span class="var type1" id="S10T3U15">Ts</span> = <span class="mxinfo " id="T3:U11"><span class="mxinfo " id="T3:U12">1</span>/<span class="var type1" id="S6T3U18">fs</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T3:U14"><span class="var type1" id="S11T3U21">w12</span> = <span class="mxinfo " id="T3:U16"><span class="mxinfo " id="T3:U17"><span class="mxinfo " id="T3:U18">pi</span>*<span class="var type1" id="S5T3U26">f0</span></span>./<span class="var type1" id="S9T3U27">QL</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">%---------- Define System from identified greybox model------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T182:U21"><span class="var type1" id="S13T182U30">A</span> = <span class="mxinfo " id="T182:U23">diag(<span class="mxinfo " id="T5:U24">-1./<span class="var type1" id="S7T5U36">tau_m</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T5:U26"><span class="var type1" id="S15T5U39">B</span> = <span class="mxinfo " id="T5:U28"><span class="mxinfo " id="T5:U29"><span class="mxinfo " id="T3:U30">-2*pi</span>*<span class="var type1" id="S8T5U47">K_m</span></span>./<span class="var type1" id="S7T5U48">tau_m</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% ------------- Discrete State Space System -----------------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T59:U33"><span class="var type1" id="S2T59U51">dx</span> = <span class="mxinfo " id="T59:U35">zeros(<span class="mxinfo " id="T3:U36">2+length(<span class="var type1" id="S15T5U58">B</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,11" id="srcline11">11</a></span><span class="line"><span class="comment">% ---------- Values---------</span></span></span>
<span class="srcline"><span class="lineno"><a href="182,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo " id="T3:U38"><span class="var type1" id="S18T3U62">a0</span> = <span class="mxinfo " id="T3:U40"><span class="mxinfo " id="T3:U41">-<span class="mxinfo " id="T3:U42">1</span></span>+ <span class="mxinfo " id="T3:U43"><span class="var type1" id="S11T3U67">w12</span>*<span class="var type1" id="S10T3U68">Ts</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo " id="T3:U46"><span class="var type1" id="S19T3U71">b0</span> = <span class="mxinfo " id="T3:U48"><span class="mxinfo " id="T3:U49"><span class="mxinfo " id="T3:U50">2</span>*<span class="var type1" id="S11T3U75">w12</span></span>*<span class="var type1" id="S10T3U76">Ts</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo " id="T3:U53">[<span class="var type1" id="S20T3U80">n</span>,<span class="mxinfo " id="T3:U55">~</span>] = size(<span class="var type1" id="S13T182U84">A</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T182:U57"><span class="var type1" id="S22T182U87">A_d</span> = <span class="mxinfo " id="T182:U59">(<span class="mxinfo " id="T182:U60"><span class="mxinfo " id="T182:U61">eye(<span class="var type1" id="S20T3U93">n</span>,<span class="var type1" id="S20T3U94">n</span>)</span>+<span class="mxinfo " id="T182:U64"><span class="mxinfo " id="T182:U65"><span class="mxinfo " id="T3:U66">0.5</span>*<span class="var type1" id="S13T182U98">A</span></span>*<span class="var type1" id="S10T3U99">Ts</span></span></span>)*<span class="mxinfo " id="T182:U69">inv(<span class="mxinfo " id="T182:U70"><span class="mxinfo " id="T182:U71">eye(<span class="var type1" id="S20T3U105">n</span>,<span class="var type1" id="S20T3U106">n</span>)</span>-<span class="mxinfo " id="T182:U74"><span class="mxinfo " id="T182:U75"><span class="mxinfo " id="T3:U76">0.5</span>*<span class="var type1" id="S13T182U110">A</span></span>*<span class="var type1" id="S10T3U111">Ts</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo " id="T5:U79"><span class="var type1" id="S25T5U114">B_d</span> = <span class="mxinfo " id="T5:U81"><span class="var type1" id="S10T3U116">Ts</span>*<span class="var type1" id="S15T5U117">B</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo " id="T3:U84"><span class="var type1" id="S26T3U120">u1</span> = <span class="mxinfo " id="T3:U86"><span class="var type1" id="S4T7U122">u_mC</span>(<span class="mxinfo " id="T3:U88">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T3:U89"><span class="var type1" id="S27T3U126">u2</span> = <span class="mxinfo " id="T3:U91"><span class="var type1" id="S4T7U128">u_mC</span>(<span class="mxinfo " id="T3:U93">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo " id="T3:U94"><span class="mxinfo " id="T3:U95"><span class="var type1" id="S2T59U133">dx</span>(<span class="mxinfo " id="T3:U97">1</span>)</span> = <span class="mxinfo " id="T3:U98"><span class="mxinfo " id="T3:U99"><span class="mxinfo " id="T3:U100"><span class="mxinfo " id="T3:U101">-<span class="var type1" id="S18T3U139">a0</span></span>*<span class="mxinfo " id="T3:U103"><span class="var type1" id="S3T59U141">x</span>(<span class="mxinfo " id="T3:U105">1</span>)</span></span>-<span class="mxinfo " id="T3:U106"><span class="mxinfo " id="T3:U107"><span class="mxinfo " id="T3:U108">sum(<span class="mxinfo " id="T5:U109"><span class="var type1" id="S3T59U148">x</span>(<span class="mxinfo " id="T183:U111">3:3+<span class="var type1" id="S20T3U154">n</span>-1</span>)</span>)</span>*<span class="mxinfo " id="T3:U113"><span class="var type1" id="S3T59U157">x</span>(<span class="mxinfo " id="T3:U115">2</span>)</span></span>*<span class="var type1" id="S10T3U159">Ts</span></span></span> + <span class="mxinfo " id="T3:U117"><span class="var type1" id="S19T3U161">b0</span> * <span class="var type1" id="S26T3U162">u1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T3:U120"><span class="mxinfo " id="T3:U121"><span class="var type1" id="S2T59U166">dx</span>(<span class="mxinfo " id="T3:U123">2</span>)</span> = <span class="mxinfo " id="T3:U124"><span class="mxinfo " id="T3:U125"><span class="mxinfo " id="T3:U126"><span class="mxinfo " id="T3:U127"><span class="mxinfo " id="T3:U128">sum(<span class="mxinfo " id="T5:U129"><span class="var type1" id="S3T59U175">x</span>(<span class="mxinfo " id="T183:U131">3:3+<span class="var type1" id="S20T3U181">n</span>-1</span>)</span>)</span> * <span class="mxinfo " id="T3:U133"><span class="var type1" id="S3T59U184">x</span>(<span class="mxinfo " id="T3:U135">1</span>)</span></span> * <span class="var type1" id="S10T3U186">Ts</span></span> - <span class="mxinfo " id="T3:U137"><span class="var type1" id="S18T3U188">a0</span>*<span class="mxinfo " id="T3:U139"><span class="var type1" id="S3T59U190">x</span>(<span class="mxinfo " id="T3:U141">2</span>)</span></span></span> +<span class="mxinfo " id="T3:U142"><span class="var type1" id="S19T3U193">b0</span>* <span class="var type1" id="S27T3U194">u2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T186:U145"><span class="mxinfo " id="T186:U146"><span class="var type1" id="S2T59U198">dx</span>(<span class="mxinfo " id="T186:U148"><span class="mxinfo " id="T3:U149">3</span>:<span class="mxinfo " id="T3:U150">3+<span class="var type1" id="S20T3U204">n</span>-1</span></span>)</span> = <span class="mxinfo " id="T5:U152"><span class="mxinfo " id="T5:U153"><span class="var type1" id="S22T182U208">A_d</span> * <span class="mxinfo " id="T5:U155"><span class="var type1" id="S3T59U210">x</span>(<span class="mxinfo " id="T183:U157">3:3+<span class="var type1" id="S20T3U216">n</span>-1</span>)</span></span> + <span class="mxinfo " id="T5:U159"><span class="var type1" id="S25T5U219">B_d</span> * (<span class="mxinfo " id="T3:U161"><span class="mxinfo " id="T3:U162"><span class="mxinfo " id="T3:U163"><span class="var type1" id="S3T59U224">x</span>(<span class="mxinfo " id="T25:U165">1</span>)</span>.^2</span>+<span class="mxinfo " id="T3:U166"><span class="mxinfo " id="T3:U167"><span class="var type1" id="S3T59U229">x</span>(<span class="mxinfo " id="T25:U169">2</span>)</span>.^2</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="182,22" id="srcline22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="182,23" id="srcline23">23</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
