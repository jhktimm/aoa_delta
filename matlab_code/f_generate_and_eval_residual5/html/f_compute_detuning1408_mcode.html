<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="204,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T1U3">dw</span>] = f_compute_detuning(<span class="var type1" id="S3T17U6">y_mC</span>, <span class="var type1" id="S4T17U7">u_mC</span>, <span class="var type1" id="S5T2U8">fs</span>, <span class="var type1" id="S6T2U9">QL</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="204,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="204,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%-------- Calculate w12 with the decay time--------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T2:U6">[<span class="var type1" id="S7T2U13">numOfSampl</span>,<span class="var type1" id="S8T2U14">numOfPulses</span>] = size(<span class="var type1" id="S3T17U17">y_mC</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T2:U10"><span class="var type1" id="S10T2U20">f0</span> = <span class="mxinfo " id="T2:U12">1.3e9</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T2:U13"><span class="var type1" id="S11T2U24">w12</span> = <span class="mxinfo " id="T2:U15"><span class="mxinfo " id="T2:U16"><span class="var type1" id="S10T2U27">f0</span>*pi</span>./<span class="var type1" id="S6T2U30">QL</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T209:U19"><span class="var type1" id="S11T209U33">w12</span> = <span class="mxinfo " id="T209:U21">repmat(<span class="var type1" id="S11T2U36">w12</span>, <span class="mxinfo " id="T32:U23">[<span class="var type1" id="S7T2U39">numOfSampl</span>,<span class="mxinfo " id="T2:U25">1</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T2:U26"><span class="var type1" id="S14T2U43">dt</span> = <span class="mxinfo " id="T2:U28"><span class="mxinfo " id="T2:U29">1</span>/<span class="var type1" id="S5T2U46">fs</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="204,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo " id="T2:U31"><span class="var type1" id="S15T2U49">smooth_span</span> = <span class="mxinfo " id="T2:U33">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo " id="T1:U34"><span class="var type1" id="S16T1U53">dVI</span> = <span class="mxinfo " id="T1:U36">zeros(<span class="var type1" id="S7T2U56">numOfSampl</span>, <span class="var type1" id="S8T2U57">numOfPulses</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,11" id="srcline11">11</a></span><span class="line">    <span class="mxinfo " id="T1:U39"><span class="var type1" id="S18T1U60">dVQ</span> = <span class="mxinfo " id="T1:U41">zeros(<span class="var type1" id="S7T2U63">numOfSampl</span>, <span class="var type1" id="S8T2U64">numOfPulses</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,12" id="srcline12">12</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S19T2U67">k</span> = <span class="mxinfo " id="T2:U45">1:<span class="var type1" id="S8T2U70">numOfPulses</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="204,13" id="srcline13">13</a></span><span class="line">        <span class="mxinfo " id="T1:U47"><span class="mxinfo " id="T1:U48"><span class="var type1" id="S16T1U74">dVI</span>(<span class="mxinfo " id="T37:U50">:</span>,<span class="var type1" id="S19T2U76">k</span>)</span> = <span class="mxinfo " id="T1:U52">[<span class="mxinfo " id="T2:U53">0</span> ; <span class="mxinfo " id="T1:U54"><span class="mxinfo " id="T1:U55">diff(<span class="mxinfo " id="T1:U56">real(<span class="mxinfo " id="T17:U57"><span class="var type1" id="S3T17U87">y_mC</span>(<span class="mxinfo " id="T37:U59">:</span>,<span class="var type1" id="S19T2U89">k</span>)</span>)</span>)</span>/<span class="var type1" id="S14T2U90">dt</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,14" id="srcline14">14</a></span><span class="line">        <span class="mxinfo " id="T1:U62"><span class="mxinfo " id="T1:U63"><span class="var type1" id="S18T1U94">dVQ</span>(<span class="mxinfo " id="T37:U65">:</span>,<span class="var type1" id="S19T2U96">k</span>)</span> = <span class="mxinfo " id="T1:U67">[<span class="mxinfo " id="T2:U68">0</span> ; <span class="mxinfo " id="T1:U69"><span class="mxinfo " id="T1:U70">diff(<span class="mxinfo " id="T1:U71">imag(<span class="mxinfo " id="T17:U72"><span class="var type1" id="S3T17U107">y_mC</span>(<span class="mxinfo " id="T37:U74">:</span>,<span class="var type1" id="S19T2U109">k</span>)</span>)</span>)</span>/<span class="var type1" id="S14T2U110">dt</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,15" id="srcline15">15</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,16" id="srcline16">16</a></span><span class="line">    <span class="comment">%if sum(sum(isnan(dVI)))&gt; 0 || sum(sum(isnan(dVQ)))&gt;0</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,17" id="srcline17">17</a></span><span class="line">    <span class="comment">%    warning('the values of dw could not be calculated correctly!')</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,18" id="srcline18">18</a></span><span class="line">    <span class="comment">%end</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,19" id="srcline19">19</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="204,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T1:U77"><span class="var type1" id="S23T1U113">dw1</span> = <span class="mxinfo " id="T1:U79"><span class="mxinfo " id="T1:U80">real(<span class="var type1" id="S3T17U118">y_mC</span>).*(<span class="mxinfo " id="T1:U82"><span class="var type1" id="S18T1U121">dVQ</span> - <span class="mxinfo " id="T1:U84"><span class="mxinfo " id="T209:U85"><span class="mxinfo " id="T2:U86">2</span>*<span class="var type1" id="S11T209U125">w12</span></span>.*imag(<span class="var type1" id="S4T17U128">u_mC</span>)</span></span>)</span>./<span class="mxinfo " id="T1:U89"><span class="mxinfo " id="T1:U90">abs(<span class="var type1" id="S3T17U132">y_mC</span>)</span>.^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo " id="T1:U92"><span class="var type1" id="S25T1U136">dw2</span> = <span class="mxinfo " id="T1:U94"><span class="mxinfo " id="T1:U95">imag(<span class="var type1" id="S3T17U141">y_mC</span>).*(<span class="mxinfo " id="T1:U97"><span class="mxinfo " id="T1:U98"><span class="mxinfo " id="T209:U99"><span class="mxinfo " id="T2:U100">2</span>*<span class="var type1" id="S11T209U147">w12</span></span>.*real(<span class="var type1" id="S4T17U150">u_mC</span>)</span> - <span class="var type1" id="S16T1U151">dVI</span></span>)</span>./<span class="mxinfo " id="T1:U104"><span class="mxinfo " id="T1:U105">abs(<span class="var type1" id="S3T17U155">y_mC</span>)</span>.^2</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,22" id="srcline22">22</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="204,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T1:U107"><span class="var type1" id="S2T1U159">dw</span> = <span class="mxinfo " id="T1:U109">zeros(<span class="var type1" id="S7T2U162">numOfSampl</span>, <span class="var type1" id="S8T2U163">numOfPulses</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,24" id="srcline24">24</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S19T2U166">k</span> = <span class="mxinfo " id="T2:U113">1:<span class="var type1" id="S8T2U169">numOfPulses</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="204,25" id="srcline25">25</a></span><span class="line">        <span class="mxinfo " id="T1:U115"><span class="mxinfo " id="T1:U116"><span class="var type1" id="S2T1U173">dw</span>(<span class="mxinfo " id="T37:U118">:</span>, <span class="var type1" id="S19T2U175">k</span>)</span> = (<span class="mxinfo " id="T1:U120"><span class="mxinfo " id="T1:U121"><span class="var type1" id="S23T1U179">dw1</span>(<span class="mxinfo " id="T37:U123">:</span>,<span class="var type1" id="S19T2U181">k</span>)</span> + <span class="mxinfo " id="T1:U125"><span class="var type1" id="S25T1U183">dw2</span>(<span class="mxinfo " id="T37:U127">:</span>,<span class="var type1" id="S19T2U185">k</span>)</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,26" id="srcline26">26</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T214:U129"><span class="var type1" id="S26T214U188">v</span> = <span class="mxinfo " id="T214:U131"><span class="mxinfo " id="T9:U132">isnan(<span class="var type1" id="S2T1U192">dw</span>)</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T2:U134"><span class="var type1" id="S28T2U195">vs</span> = <span class="mxinfo " id="T2:U136">sum(<span class="var type1" id="S26T214U198">v</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="204,29" id="srcline29">29</a></span><span class="line">    <span class="comment">%-----------Plot--------------</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,30" id="srcline30">30</a></span><span class="line"><span class="comment">%     figure(555)</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,31" id="srcline31">31</a></span><span class="line"><span class="comment">%     hold on</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,32" id="srcline32">32</a></span><span class="line"><span class="comment">%     plot([1:1:length(dw)-1]*1e-6,dw(1:end-1))</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,33" id="srcline33">33</a></span><span class="line"><span class="comment">%     xlabel('Time')</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,34" id="srcline34">34</a></span><span class="line"><span class="comment">%     ylabel('\Delta\omega')</span></span></span>
<span class="srcline"><span class="lineno"><a href="204,35" id="srcline35">35</a></span><span class="line"><span class="comment">%     </span></span></span>
<span class="srcline"><span class="lineno"><a href="204,36" id="srcline36">36</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
</body>
</html>
