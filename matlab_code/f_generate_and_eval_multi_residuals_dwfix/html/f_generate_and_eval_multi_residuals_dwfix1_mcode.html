<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">s_max_UKF</span>, <span class="var type1" id="S3T1U4">s_max_UKF_dwfix</span>, <span class="var type1" id="S4T1U5">s_max_dw</span>, <span class="var type1" id="S5T1U6">s_max_PS1</span>, <span class="var type1" id="S6T1U7">res_PS2</span>, <span class="var type1" id="S7T2U8">classis_UKF</span>, <span class="var type1" id="S8T2U9">classis_dwfix</span>, <span class="var type1" id="S9T2U10">classis_PS</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line">    <span class="var type1" id="S10T2U11">classis_dw</span>, <span class="var type1" id="S11T2U12">strengthis_UKF</span>, <span class="var type1" id="S12T2U13">strengthis_dwfix</span>, <span class="var type1" id="S13T2U14">strengthis_PS</span>, <span class="var type1" id="S14T2U15">strengthis_dw</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line">    <span class="var type1" id="S15T2U16">max_UKF</span>, <span class="var type1" id="S16T2U17">max_dwfix</span>, <span class="var type1" id="S17T2U18">max_PS</span>, <span class="var type1" id="S18T2U19">max_dw</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line">    <span class="var type1" id="S19T2U20">median_UKF</span>, <span class="var type1" id="S20T2U21">median_dwfix</span>, <span class="var type1" id="S21T2U22">median_PS</span>, <span class="var type1" id="S22T2U23">median_dw</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line">    <span class="var type1" id="S23T2U24">mode_UKF</span>, <span class="var type1" id="S24T2U25">mode_dwfix</span>, <span class="var type1" id="S25T2U26">mode_PS</span>, <span class="var type1" id="S26T2U27">mode_dw</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line">    <span class="var type1" id="S27T2U28">var_UKF</span>, <span class="var type1" id="S28T2U29">var_dwfix</span>, <span class="var type1" id="S29T2U30">var_PS</span>, <span class="var type1" id="S30T2U31">var_dw</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line">    <span class="var type1" id="S31T2U32">rm_I</span>,<span class="var type1" id="S32T2U33">rm_Q</span>,<span class="var type1" id="S33T2U34">rm_I_dwfix</span>, <span class="var type1" id="S34T2U35">rm_Q_dwfix</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line">    <span class="var type1" id="S35T2U36">rvar_1</span>, <span class="var type1" id="S36T2U37">rvar_2</span>, <span class="var type1" id="S37T2U38">rvar_3</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line">    <span class="var type1" id="S38T2U39">QL</span>, <span class="var type1" id="S39T2U40">dw_stat</span>, <span class="var type1" id="S40T2U41">SP_F</span>, <span class="var type1" id="S41T2U42">SP_P</span>, <span class="var type1" id="S42T2U43">PC</span>, <span class="var type1" id="S43T2U44">calib_check</span>, <span class="var type1" id="S44T2U45">dec_hq</span>,<span class="var type1" id="S45T2U46">zpth</span>] = <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line">    f_generate_and_eval_multi_residuals_dwfix( <span class="var type1" id="S46T1U49">PA</span>, <span class="var type1" id="S47T1U50">PP</span>, <span class="var type1" id="S48T1U51">FA</span>, <span class="var type1" id="S49T1U52">FP</span>, <span class="var type1" id="S50T1U53">RA</span>, <span class="var type1" id="S51T1U54">RP</span>, <span class="var type1" id="S52T2U55">FS</span>, <span class="var type1" id="S53T2U56">F0</span>, <span class="var type1" id="S54T3U57">cal_coeff</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line">    , <span class="var type1" id="S55T1U58">dwfix</span>,<span class="var type1" id="S56T4U59">tau_m</span>, <span class="var type1" id="S57T4U60">K_m</span>, <span class="var type1" id="S58T4U61">X0</span>, <span class="var type1" id="S59T2U62">QL_nom</span>, <span class="var type1" id="S60T2U63">DELAY</span>, <span class="var type1" id="S61T2U64">FILLING</span>, <span class="var type1" id="S62T2U65">FLATTOP</span>, <span class="var type1" id="S63T5U66">Sigma_nom_UKF</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line">    <span class="var type1" id="S64T5U67">Sigma_nom_UKF_dwfix</span>,<span class="var type1" id="S65T6U68">r_mean_nom_UKF_dwfix</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line">    <span class="var type1" id="S66T6U69">r_mean_nom_UKF</span>, <span class="var type1" id="S67T5U70">MeasNoiseVar</span>, <span class="var type1" id="S68T7U71">ProcessVar</span>, <span class="var type1" id="S69T2U72">alpha</span><span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line">    ,<span class="var type1" id="S70T2U73">Sigma_nom_dw</span>, <span class="var type1" id="S71T1U74">r_PS1_nom</span>, <span class="var type1" id="S72T2U75">Sigma_nom_PS1</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% This function evaluates the residual</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="mxinfo " id="T2:U72"><span class="var type1" id="S73T2U78">fs</span> = <span class="mxinfo " id="T2:U74"><span class="var type1" id="S52T2U80">FS</span>*<span class="mxinfo " id="T2:U76">1e6</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="mxinfo " id="T2:U77"><span class="var type1" id="S74T2U84">f0</span> = <span class="mxinfo " id="T2:U79"><span class="var type1" id="S53T2U86">F0</span>*<span class="mxinfo " id="T2:U81">1e6</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="mxinfo " id="T2:U82"><span class="var type1" id="S75T2U90">idxIgn</span>=<span class="mxinfo " id="T2:U84">60</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U85"><span class="var type1" id="S73T2U95">fs</span> ==<span class="mxinfo " id="T2:U87">1e6</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line">    <span class="mxinfo " id="T9:U88"><span class="var type1" id="S76T9U99">Rise</span> = <span class="mxinfo " id="T9:U90"><span class="mxinfo " id="T2:U91">round(<span class="mxinfo " id="T2:U92"><span class="mxinfo " id="T2:U93"><span class="var type1" id="S60T2U105">DELAY</span> * <span class="var type1" id="S73T2U106">fs</span></span> *<span class="mxinfo " id="T2:U96">1e-6</span></span>)</span>:<span class="mxinfo " id="T2:U97">round(<span class="mxinfo " id="T2:U98"><span class="mxinfo " id="T2:U99"><span class="mxinfo " id="T2:U100"><span class="var type1" id="S60T2U113">DELAY</span> * <span class="var type1" id="S73T2U114">fs</span></span>*<span class="mxinfo " id="T2:U103">1e-6</span></span>+ <span class="mxinfo " id="T2:U104"><span class="mxinfo " id="T2:U105"><span class="var type1" id="S61T2U118">FILLING</span>*<span class="var type1" id="S73T2U119">fs</span></span>*<span class="mxinfo " id="T2:U108">1e-6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line">    <span class="mxinfo " id="T9:U109"><span class="var type1" id="S78T9U123">Flattop</span> = <span class="mxinfo " id="T9:U111"><span class="mxinfo " id="T2:U112"><span class="mxinfo " id="T2:U113"><span class="var type1" id="S76T9U127">Rise</span>(<span class="mxinfo " id="T2:U115">end</span>)</span>+<span class="mxinfo " id="T2:U116">1</span></span> : <span class="mxinfo " id="T2:U117"><span class="mxinfo " id="T2:U118"><span class="mxinfo " id="T2:U119"><span class="var type1" id="S76T9U134">Rise</span>(<span class="mxinfo " id="T2:U121">end</span>)</span>+<span class="mxinfo " id="T2:U122">1</span></span>+<span class="mxinfo " id="T2:U123">round(<span class="mxinfo " id="T2:U124"><span class="mxinfo " id="T2:U125"><span class="var type1" id="S62T2U142">FLATTOP</span>*<span class="var type1" id="S73T2U143">fs</span></span>*<span class="mxinfo " id="T2:U128">1e-6</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line">    <span class="mxinfo " id="T9:U129"><span class="var type1" id="S80T9U147">Decay</span> = <span class="mxinfo " id="T9:U131"><span class="mxinfo " id="T2:U132"><span class="mxinfo " id="T2:U133"><span class="var type1" id="S78T9U151">Flattop</span>(<span class="mxinfo " id="T2:U135">end</span>)</span>+<span class="mxinfo " id="T2:U136">1</span></span> : round(2^(14)/9+1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line">    <span class="mxinfo " id="T9:U137"><span class="var type1" id="S76T9U168">Rise</span> = <span class="mxinfo " id="T9:U139"><span class="mxinfo " id="T2:U140">round(<span class="mxinfo " id="T2:U141"><span class="mxinfo " id="T2:U142"><span class="var type1" id="S60T2U174">DELAY</span> * <span class="var type1" id="S73T2U175">fs</span></span> *<span class="mxinfo " id="T2:U145">1e-6</span></span>)</span>:<span class="mxinfo " id="T2:U146">round(<span class="mxinfo " id="T2:U147"><span class="mxinfo " id="T2:U148"><span class="mxinfo " id="T2:U149"><span class="var type1" id="S60T2U182">DELAY</span> * <span class="var type1" id="S73T2U183">fs</span></span>*<span class="mxinfo " id="T2:U152">1e-6</span></span>+ <span class="mxinfo " id="T2:U153"><span class="mxinfo " id="T2:U154"><span class="var type1" id="S61T2U187">FILLING</span>*<span class="var type1" id="S73T2U188">fs</span></span>*<span class="mxinfo " id="T2:U157">1e-6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line">    <span class="mxinfo " id="T9:U158"><span class="var type1" id="S78T9U192">Flattop</span> = <span class="mxinfo " id="T9:U160"><span class="mxinfo " id="T2:U161"><span class="mxinfo " id="T2:U162"><span class="var type1" id="S76T9U196">Rise</span>(<span class="mxinfo " id="T2:U164">end</span>)</span>+<span class="mxinfo " id="T2:U165">1</span></span> : <span class="mxinfo " id="T2:U166"><span class="mxinfo " id="T2:U167"><span class="mxinfo " id="T2:U168"><span class="var type1" id="S76T9U203">Rise</span>(<span class="mxinfo " id="T2:U170">end</span>)</span>+<span class="mxinfo " id="T2:U171">1</span></span>+<span class="mxinfo " id="T2:U172">round(<span class="mxinfo " id="T2:U173"><span class="mxinfo " id="T2:U174"><span class="var type1" id="S62T2U211">FLATTOP</span>*<span class="var type1" id="S73T2U212">fs</span></span>*<span class="mxinfo " id="T2:U177">1e-6</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line">    <span class="mxinfo " id="T9:U178"><span class="var type1" id="S80T9U216">Decay</span> = <span class="mxinfo " id="T9:U180"><span class="mxinfo " id="T2:U181"><span class="mxinfo " id="T2:U182"><span class="var type1" id="S78T9U220">Flattop</span>(<span class="mxinfo " id="T2:U184">end</span>)</span>+<span class="mxinfo " id="T2:U185">1</span></span> : 2^(14)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="mxinfo " id="T2:U186"><span class="var type1" id="S81T2U230">s</span> = <span class="mxinfo " id="T2:U188">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="keyword">while</span> <span class="mxinfo " id="T8:U189"><span class="mxinfo " id="T2:U190">sum(<span class="mxinfo " id="T10:U191"><span class="mxinfo " id="T1:U192"><span class="var type1" id="S47T1U240">PP</span>(<span class="mxinfo " id="T9:U194"><span class="var type1" id="S75T2U242">idxIgn</span>:end</span>)</span> == <span class="mxinfo " id="T2:U196">0</span></span>)</span> &gt; <span class="mxinfo " id="T2:U197">0</span></span> || <span class="mxinfo " id="T8:U198"><span class="mxinfo " id="T2:U199">sum(<span class="mxinfo " id="T11:U200"><span class="mxinfo " id="T12:U201"><span class="var type1" id="S49T1U252">FP</span>(<span class="mxinfo " id="T13:U203"><span class="var type1" id="S75T2U254">idxIgn</span>:<span class="mxinfo " id="T2:U205">1420</span></span>)</span> == <span class="mxinfo " id="T2:U206">0</span></span>)</span> &gt; <span class="mxinfo " id="T2:U207">0</span></span> || <span class="mxinfo " id="T8:U208"><span class="mxinfo " id="T2:U209">sum(<span class="mxinfo " id="T10:U210"><span class="mxinfo " id="T1:U211"><span class="var type1" id="S51T1U263">RP</span>(<span class="mxinfo " id="T9:U213"><span class="var type1" id="S75T2U265">idxIgn</span>:end</span>)</span> == <span class="mxinfo " id="T2:U215">0</span></span>)</span> &gt; <span class="mxinfo " id="T2:U216">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line">    <span class="mxinfo " id="T1:U217"><span class="var type1" id="S83T1U272">idxP</span> = <span class="mxinfo " id="T1:U219">find(<span class="mxinfo " id="T10:U220"><span class="mxinfo " id="T1:U221"><span class="var type1" id="S47T1U277">PP</span>(<span class="mxinfo " id="T9:U223"><span class="var type1" id="S75T2U279">idxIgn</span>:end</span>)</span> == <span class="mxinfo " id="T2:U225">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line">    <span class="mxinfo " id="T1:U226"><span class="mxinfo " id="T1:U227"><span class="var type1" id="S47T1U286">PP</span>(<span class="mxinfo " id="T1:U229"><span class="mxinfo " id="T1:U230"><span class="var type1" id="S75T2U289">idxIgn</span>+<span class="var type1" id="S83T1U290">idxP</span></span>-<span class="mxinfo " id="T2:U233">1</span></span>)</span> = <span class="mxinfo " id="T1:U234"><span class="var type1" id="S47T1U293">PP</span>(<span class="mxinfo " id="T1:U236"><span class="mxinfo " id="T1:U237"><span class="var type1" id="S75T2U296">idxIgn</span>+<span class="var type1" id="S83T1U297">idxP</span></span>-<span class="mxinfo " id="T2:U240">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line">    <span class="mxinfo " id="T14:U241"><span class="var type1" id="S85T14U301">idxF</span> = <span class="mxinfo " id="T14:U243">find(<span class="mxinfo " id="T11:U244"><span class="mxinfo " id="T12:U245"><span class="var type1" id="S49T1U306">FP</span>(<span class="mxinfo " id="T13:U247"><span class="var type1" id="S75T2U308">idxIgn</span>:<span class="mxinfo " id="T2:U249">1420</span></span>)</span> == <span class="mxinfo " id="T2:U250">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line">    <span class="mxinfo " id="T14:U251"><span class="mxinfo " id="T14:U252"><span class="var type1" id="S49T1U314">FP</span>(<span class="mxinfo " id="T14:U254"><span class="mxinfo " id="T14:U255"><span class="var type1" id="S75T2U317">idxIgn</span>+<span class="var type1" id="S85T14U318">idxF</span></span>-<span class="mxinfo " id="T2:U258">1</span></span>)</span> = <span class="mxinfo " id="T14:U259"><span class="var type1" id="S49T1U321">FP</span>(<span class="mxinfo " id="T14:U261"><span class="mxinfo " id="T14:U262"><span class="var type1" id="S75T2U324">idxIgn</span>+<span class="var type1" id="S85T14U325">idxF</span></span>-<span class="mxinfo " id="T2:U265">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line">    <span class="mxinfo " id="T1:U266"><span class="var type1" id="S86T1U329">idxR</span> = <span class="mxinfo " id="T1:U268">find(<span class="mxinfo " id="T10:U269"><span class="mxinfo " id="T1:U270"><span class="var type1" id="S51T1U334">RP</span>(<span class="mxinfo " id="T9:U272"><span class="var type1" id="S75T2U336">idxIgn</span>:end</span>)</span> == <span class="mxinfo " id="T2:U274">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line">    <span class="mxinfo " id="T1:U275"><span class="mxinfo " id="T1:U276"><span class="var type1" id="S51T1U343">RP</span>(<span class="mxinfo " id="T1:U278"><span class="mxinfo " id="T1:U279"><span class="var type1" id="S75T2U346">idxIgn</span>+<span class="var type1" id="S86T1U347">idxR</span></span>-<span class="mxinfo " id="T2:U282">1</span></span>)</span> = <span class="mxinfo " id="T1:U283"><span class="var type1" id="S51T1U350">RP</span>(<span class="mxinfo " id="T1:U285"><span class="mxinfo " id="T1:U286"><span class="var type1" id="S75T2U353">idxIgn</span>+<span class="var type1" id="S86T1U354">idxR</span></span>-<span class="mxinfo " id="T2:U289">2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line">    <span class="mxinfo " id="T2:U290"><span class="var type1" id="S81T2U358">s</span>=<span class="mxinfo " id="T2:U292"><span class="var type1" id="S81T2U360">s</span>+<span class="mxinfo " id="T2:U294">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T8:U295"><span class="var type1" id="S81T2U365">s</span> &gt; <span class="mxinfo " id="T2:U297">500</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line">        <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T8:U298"><span class="mxinfo " id="T2:U299">mean(<span class="mxinfo " id="T1:U300"><span class="var type1" id="S48T1U376">FA</span>(<span class="var type1" id="S76T9U377">Rise</span>)</span>)</span> &gt; <span class="mxinfo " id="T2:U303">3</span></span> &amp;&amp; <span class="mxinfo " id="T8:U304"><span class="mxinfo " id="T2:U305">mean(<span class="mxinfo " id="T1:U306"><span class="var type1" id="S46T1U383">PA</span>(<span class="var type1" id="S78T9U384">Flattop</span>)</span>)</span> &gt;<span class="mxinfo " id="T2:U309">3</span></span> &amp;&amp; <span class="mxinfo " id="T8:U310">~(<span class="mxinfo " id="T8:U311"><span class="var type1" id="S81T2U389">s</span> &gt; <span class="mxinfo " id="T2:U313">1820</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line">    <span class="comment">%% Unscented Kalman Filter Residual Generation + GLRT Evaluation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line">    [<span class="var type1" id="S88T15U394">res_full_mean</span>, <span class="var type1" id="S89T16U395">res_full_variance</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line">        = f_generate_online_UKF_residual_full(<span class="var type1" id="S46T1U398">PA</span>,<span class="var type1" id="S47T1U399">PP</span>, <span class="var type1" id="S48T1U400">FA</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line">        <span class="var type1" id="S49T1U401">FP</span>, <span class="var type1" id="S50T1U402">RA</span>, <span class="var type1" id="S51T1U403">RP</span>, <span class="var type1" id="S52T2U404">FS</span>, <span class="var type1" id="S53T2U405">F0</span>, <span class="var type1" id="S54T3U406">cal_coeff</span>, <span class="var type1" id="S56T4U407">tau_m</span>, <span class="var type1" id="S57T4U408">K_m</span>, <span class="var type1" id="S58T4U409">X0</span>, <span class="var type1" id="S59T2U410">QL_nom</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">        <span class="var type1" id="S60T2U411">DELAY</span>, <span class="var type1" id="S61T2U412">FILLING</span>, <span class="var type1" id="S62T2U413">FLATTOP</span> ,<span class="var type1" id="S67T5U414">MeasNoiseVar</span>,<span class="var type1" id="S68T7U415">ProcessVar</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line">    <span class="mxinfo " id="T15:U334"><span class="var type1" id="S91T15U418">y</span> = <span class="mxinfo " id="T15:U336">zeros(<span class="mxinfo " id="T2:U337">2</span>, <span class="mxinfo " id="T2:U338">length(<span class="var type1" id="S88T15U424">res_full_mean</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S94T2U427">ii</span> = <span class="mxinfo " id="T2:U341">1</span>:<span class="mxinfo " id="T2:U342">length(<span class="var type1" id="S88T15U432">res_full_mean</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">        <span class="mxinfo " id="T6:U344"><span class="mxinfo " id="T6:U345"><span class="var type1" id="S91T15U436">y</span>(<span class="mxinfo " id="T17:U347">:</span>,<span class="var type1" id="S94T2U438">ii</span>)</span> = <span class="mxinfo " id="T6:U349"><span class="mxinfo " id="T6:U350"><span class="var type1" id="S88T15U441">res_full_mean</span>(<span class="mxinfo " id="T17:U352">:</span>,<span class="var type1" id="S94T2U443">ii</span>)</span> - <span class="var type1" id="S66T6U444">r_mean_nom_UKF</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    <span class="comment">%     figure(9)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">    <span class="comment">%     plot(res_full_mean(1,45:end), res_full_mean(2,45:end), '.')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="comment">%     hold on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo " id="T2:U355"><span class="var type1" id="S95T2U447">N</span>=<span class="mxinfo " id="T2:U357">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="mxinfo " id="T1:U358">[<span class="var type1" id="S2T1U452">s_max_UKF</span>] = <span class="mxinfo " id="T1:U360"><span class="mxinfo " id="T9:U361"><span class="fcn" id="F1287N6:B455">f_GLT</span>(<span class="var type1" id="S63T5U456">Sigma_nom_UKF</span>, <span class="var type1" id="S91T15U457">y</span>, <span class="var type1" id="S95T2U458">N</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo " id="T2:U365"><span class="var type1" id="S31T2U461">rm_I</span> = <span class="mxinfo " id="T2:U367">mean(<span class="mxinfo " id="T9:U368"><span class="var type1" id="S88T15U465">res_full_mean</span>(<span class="mxinfo " id="T18:U370">1</span>,<span class="mxinfo " id="T9:U371"><span class="var type1" id="S75T2U468">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo " id="T2:U373"><span class="var type1" id="S32T2U473">rm_Q</span> = <span class="mxinfo " id="T2:U375">mean(<span class="mxinfo " id="T9:U376"><span class="var type1" id="S88T15U477">res_full_mean</span>(<span class="mxinfo " id="T18:U378">2</span>,<span class="mxinfo " id="T9:U379"><span class="var type1" id="S75T2U480">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo " id="T19:U381"><span class="var type1" id="S97T19U485">res_var</span> = <span class="mxinfo " id="T19:U383">cov(<span class="mxinfo " id="T20:U384"><span class="mxinfo " id="T15:U385"><span class="var type1" id="S88T15U490">res_full_mean</span>(<span class="mxinfo " id="T17:U387">:</span>,<span class="mxinfo " id="T9:U388"><span class="var type1" id="S75T2U493">idxIgn</span>:end</span>)</span>.'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    <span class="mxinfo " id="T2:U390"><span class="var type1" id="S35T2U498">rvar_1</span> = <span class="mxinfo " id="T2:U392"><span class="var type1" id="S97T19U500">res_var</span>(<span class="mxinfo " id="T2:U394">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="mxinfo " id="T2:U395"><span class="var type1" id="S36T2U504">rvar_2</span> = <span class="mxinfo " id="T2:U397"><span class="var type1" id="S97T19U506">res_var</span>(<span class="mxinfo " id="T2:U399">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="mxinfo " id="T2:U400"><span class="var type1" id="S37T2U510">rvar_3</span> = <span class="mxinfo " id="T2:U402"><span class="var type1" id="S97T19U512">res_var</span>(<span class="mxinfo " id="T2:U404">3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    [<span class="var type1" id="S99T15U517">res_full_mean_dwfix</span>, <span class="var type1" id="S100T16U518">res_full_variance_dwfix</span>]<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">        = f_generate_online_UKF_residual_full_dwfix(<span class="var type1" id="S46T1U521">PA</span>,<span class="var type1" id="S47T1U522">PP</span>, <span class="var type1" id="S48T1U523">FA</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">        <span class="var type1" id="S49T1U524">FP</span>, <span class="var type1" id="S50T1U525">RA</span>, <span class="var type1" id="S51T1U526">RP</span>, <span class="var type1" id="S52T2U527">FS</span>, <span class="var type1" id="S53T2U528">F0</span>, <span class="var type1" id="S54T3U529">cal_coeff</span>, <span class="var type1" id="S55T1U530">dwfix</span>, <span class="var type1" id="S59T2U531">QL_nom</span>,<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">        <span class="var type1" id="S60T2U532">DELAY</span>, <span class="var type1" id="S61T2U533">FILLING</span>, <span class="var type1" id="S62T2U534">FLATTOP</span> ,<span class="var type1" id="S67T5U535">MeasNoiseVar</span>,<span class="mxinfo " id="T5:U422"><span class="mxinfo " id="T5:U423"><span class="var type1" id="S68T7U538">ProcessVar</span>(<span class="mxinfo " id="T17:U425">1:2</span>,<span class="mxinfo " id="T17:U426">1:2</span>)</span>.*<span class="var type1" id="S69T2U545">alpha</span></span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">    <span class="mxinfo " id="T15:U428"><span class="var type1" id="S91T15U548">y</span> = <span class="mxinfo " id="T15:U430">zeros(<span class="mxinfo " id="T2:U431">2</span>, <span class="mxinfo " id="T2:U432">length(<span class="var type1" id="S99T15U554">res_full_mean_dwfix</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S94T2U557">ii</span> = <span class="mxinfo " id="T2:U435">1</span>:<span class="mxinfo " id="T2:U436">length(<span class="var type1" id="S99T15U562">res_full_mean_dwfix</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line">        <span class="mxinfo " id="T6:U438"><span class="mxinfo " id="T6:U439"><span class="var type1" id="S91T15U566">y</span>(<span class="mxinfo " id="T17:U441">:</span>,<span class="var type1" id="S94T2U568">ii</span>)</span> = <span class="mxinfo " id="T6:U443"><span class="mxinfo " id="T6:U444"><span class="var type1" id="S99T15U571">res_full_mean_dwfix</span>(<span class="mxinfo " id="T17:U446">:</span>,<span class="var type1" id="S94T2U573">ii</span>)</span> - <span class="var type1" id="S65T6U574">r_mean_nom_UKF_dwfix</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">    <span class="comment">%     figure(9)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">    <span class="comment">%     plot(res_full_mean_dwfix(1,45:end), res_full_mean_dwfix(2,45:end), '.')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">    <span class="comment">%     hold on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    <span class="mxinfo " id="T2:U449"><span class="var type1" id="S95T2U577">N</span>=<span class="mxinfo " id="T2:U451">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">    <span class="mxinfo " id="T1:U452">[<span class="var type1" id="S3T1U582">s_max_UKF_dwfix</span>] = <span class="mxinfo " id="T1:U454"><span class="mxinfo " id="T9:U455"><span class="fcn" id="F1287N6:B585">f_GLT</span>(<span class="var type1" id="S64T5U586">Sigma_nom_UKF_dwfix</span>, <span class="var type1" id="S91T15U587">y</span>, <span class="var type1" id="S95T2U588">N</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">    <span class="mxinfo " id="T2:U459"><span class="var type1" id="S33T2U591">rm_I_dwfix</span> = <span class="mxinfo " id="T2:U461">mean(<span class="mxinfo " id="T9:U462"><span class="var type1" id="S99T15U595">res_full_mean_dwfix</span>(<span class="mxinfo " id="T18:U464">1</span>,<span class="mxinfo " id="T9:U465"><span class="var type1" id="S75T2U598">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo " id="T2:U467"><span class="var type1" id="S34T2U603">rm_Q_dwfix</span> = <span class="mxinfo " id="T2:U469">mean(<span class="mxinfo " id="T9:U470"><span class="var type1" id="S99T15U607">res_full_mean_dwfix</span>(<span class="mxinfo " id="T18:U472">2</span>,<span class="mxinfo " id="T9:U473"><span class="var type1" id="S75T2U610">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">    <span class="comment">%% Parity Space Residual Genertation + GLRT Evaluation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">    <span class="mxinfo " id="T1:U475">[<span class="var type1" id="S102T1U616">res_PS1</span>] = <span class="mxinfo " id="T1:U477"><span class="fcn" id="F1428N19:B618">f_generate_online_parityRes1_full</span>(<span class="var type1" id="S46T1U619">PA</span>, <span class="var type1" id="S47T1U620">PP</span>, <span class="var type1" id="S48T1U621">FA</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">        <span class="var type1" id="S49T1U622">FP</span>, <span class="var type1" id="S50T1U623">RA</span>, <span class="var type1" id="S51T1U624">RP</span>, <span class="var type1" id="S52T2U625">FS</span>, <span class="var type1" id="S53T2U626">F0</span>, <span class="var type1" id="S54T3U627">cal_coeff</span>,<span class="var type1" id="S59T2U628">QL_nom</span>, <span class="var type1" id="S60T2U629">DELAY</span>, <span class="var type1" id="S61T2U630">FILLING</span>, <span class="var type1" id="S62T2U631">FLATTOP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">    <span class="mxinfo " id="T1:U491">[<span class="var type1" id="S6T1U635">res_PS2</span>] = <span class="mxinfo " id="T1:U493"><span class="fcn" id="F1647N20:B637">f_generate_online_parityRes2_full</span>(<span class="var type1" id="S46T1U638">PA</span>,<span class="var type1" id="S47T1U639">PP</span>, <span class="var type1" id="S48T1U640">FA</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">        <span class="var type1" id="S49T1U641">FP</span>, <span class="var type1" id="S50T1U642">RA</span>, <span class="var type1" id="S51T1U643">RP</span>, <span class="var type1" id="S52T2U644">FS</span>, <span class="var type1" id="S53T2U645">F0</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">        <span class="var type1" id="S54T3U646">cal_coeff</span>, <span class="var type1" id="S56T4U647">tau_m</span>, <span class="var type1" id="S57T4U648">K_m</span>,<span class="var type1" id="S59T2U649">QL_nom</span>, <span class="var type1" id="S60T2U650">DELAY</span>, <span class="var type1" id="S61T2U651">FILLING</span>, <span class="var type1" id="S62T2U652">FLATTOP</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo " id="T1:U509"><span class="var type1" id="S91T1U655">y</span> =<span class="mxinfo " id="T1:U511"><span class="var type1" id="S102T1U657">res_PS1</span> - <span class="var type1" id="S71T1U658">r_PS1_nom</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">    <span class="mxinfo " id="T2:U514"><span class="var type1" id="S95T2U661">N</span>=<span class="mxinfo " id="T2:U516">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">    <span class="mxinfo " id="T1:U517">[<span class="var type1" id="S5T1U666">s_max_PS1</span>] = <span class="mxinfo " id="T1:U519"><span class="mxinfo " id="T9:U520"><span class="fcn" id="F1668N6:B669">f_GLT</span>(<span class="var type1" id="S72T2U670">Sigma_nom_PS1</span>, <span class="mxinfo " id="T9:U522"><span class="var type1" id="S91T1U672">y</span>.'</span>, <span class="var type1" id="S95T2U673">N</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">    <span class="mxinfo " id="T2:U525"><span class="var type1" id="S9T2U676">classis_PS</span> = <span class="mxinfo " id="T2:U527">sum(<span class="mxinfo " id="T10:U528"><span class="mxinfo " id="T1:U529"><span class="var type1" id="S5T1U681">s_max_PS1</span>(<span class="mxinfo " id="T9:U531"><span class="var type1" id="S75T2U683">idxIgn</span>:end</span>)</span> &gt; <span class="mxinfo " id="T2:U533">10.8</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo " id="T2:U534"><span class="var type1" id="S13T2U689">strengthis_PS</span> = <span class="mxinfo " id="T2:U536">mean(<span class="mxinfo " id="T1:U537"><span class="var type1" id="S5T1U693">s_max_PS1</span>(<span class="mxinfo " id="T9:U539"><span class="var type1" id="S75T2U695">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">    <span class="mxinfo " id="T2:U541"><span class="var type1" id="S17T2U700">max_PS</span> = <span class="mxinfo " id="T2:U543">max(<span class="mxinfo " id="T1:U544"><span class="var type1" id="S5T1U704">s_max_PS1</span>(<span class="mxinfo " id="T9:U546"><span class="var type1" id="S75T2U706">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">    <span class="mxinfo " id="T2:U548"><span class="var type1" id="S21T2U711">median_PS</span> = <span class="mxinfo " id="T2:U550">median(<span class="mxinfo " id="T1:U551"><span class="var type1" id="S5T1U715">s_max_PS1</span>(<span class="mxinfo " id="T9:U553"><span class="var type1" id="S75T2U717">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">    <span class="mxinfo " id="T2:U555"><span class="var type1" id="S25T2U722">mode_PS</span> = <span class="mxinfo " id="T2:U557">mode(<span class="mxinfo " id="T1:U558"><span class="var type1" id="S5T1U726">s_max_PS1</span>(<span class="mxinfo " id="T9:U560"><span class="var type1" id="S75T2U728">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">    <span class="mxinfo " id="T2:U562"><span class="var type1" id="S29T2U733">var_PS</span> = <span class="mxinfo " id="T2:U564">var(<span class="mxinfo " id="T1:U565"><span class="var type1" id="S5T1U737">s_max_PS1</span>(<span class="mxinfo " id="T9:U567"><span class="var type1" id="S75T2U739">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">    <span class="comment">%% Check if GLT is above a threshold.</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="mxinfo " id="T2:U569"><span class="var type1" id="S7T2U744">classis_UKF</span> = <span class="mxinfo " id="T2:U571">sum(<span class="mxinfo " id="T10:U572"><span class="mxinfo " id="T1:U573"><span class="var type1" id="S2T1U749">s_max_UKF</span>(<span class="mxinfo " id="T9:U575"><span class="var type1" id="S75T2U751">idxIgn</span>:end</span>)</span> &gt; <span class="mxinfo " id="T2:U577">13.8</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">    <span class="mxinfo " id="T2:U578"><span class="var type1" id="S11T2U757">strengthis_UKF</span> = <span class="mxinfo " id="T2:U580">mean(<span class="mxinfo " id="T1:U581"><span class="var type1" id="S2T1U761">s_max_UKF</span>(<span class="mxinfo " id="T9:U583"><span class="var type1" id="S75T2U763">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">    <span class="mxinfo " id="T2:U585"><span class="var type1" id="S15T2U768">max_UKF</span> = <span class="mxinfo " id="T2:U587">max(<span class="mxinfo " id="T1:U588"><span class="var type1" id="S2T1U772">s_max_UKF</span>(<span class="mxinfo " id="T9:U590"><span class="var type1" id="S75T2U774">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">    <span class="mxinfo " id="T2:U592"><span class="var type1" id="S19T2U779">median_UKF</span> = <span class="mxinfo " id="T2:U594">median(<span class="mxinfo " id="T1:U595"><span class="var type1" id="S2T1U783">s_max_UKF</span>(<span class="mxinfo " id="T9:U597"><span class="var type1" id="S75T2U785">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">    <span class="mxinfo " id="T2:U599"><span class="var type1" id="S23T2U790">mode_UKF</span> = <span class="mxinfo " id="T2:U601">mode(<span class="mxinfo " id="T1:U602"><span class="var type1" id="S2T1U794">s_max_UKF</span>(<span class="mxinfo " id="T9:U604"><span class="var type1" id="S75T2U796">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">    <span class="mxinfo " id="T2:U606"><span class="var type1" id="S27T2U801">var_UKF</span> = <span class="mxinfo " id="T2:U608">var(<span class="mxinfo " id="T1:U609"><span class="var type1" id="S2T1U805">s_max_UKF</span>(<span class="mxinfo " id="T9:U611"><span class="var type1" id="S75T2U807">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">    <span class="mxinfo " id="T2:U613"><span class="var type1" id="S8T2U812">classis_dwfix</span> = <span class="mxinfo " id="T2:U615">sum(<span class="mxinfo " id="T10:U616"><span class="mxinfo " id="T1:U617"><span class="var type1" id="S3T1U817">s_max_UKF_dwfix</span>(<span class="mxinfo " id="T9:U619"><span class="var type1" id="S75T2U819">idxIgn</span>:end</span>)</span> &gt; <span class="mxinfo " id="T2:U621">13.8</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">    <span class="mxinfo " id="T2:U622"><span class="var type1" id="S12T2U825">strengthis_dwfix</span> = <span class="mxinfo " id="T2:U624">mean(<span class="mxinfo " id="T1:U625"><span class="var type1" id="S3T1U829">s_max_UKF_dwfix</span>(<span class="mxinfo " id="T9:U627"><span class="var type1" id="S75T2U831">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">    <span class="mxinfo " id="T2:U629"><span class="var type1" id="S16T2U836">max_dwfix</span> = <span class="mxinfo " id="T2:U631">max(<span class="mxinfo " id="T1:U632"><span class="var type1" id="S3T1U840">s_max_UKF_dwfix</span>(<span class="mxinfo " id="T9:U634"><span class="var type1" id="S75T2U842">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">    <span class="mxinfo " id="T2:U636"><span class="var type1" id="S20T2U847">median_dwfix</span> = <span class="mxinfo " id="T2:U638">median(<span class="mxinfo " id="T1:U639"><span class="var type1" id="S3T1U851">s_max_UKF_dwfix</span>(<span class="mxinfo " id="T9:U641"><span class="var type1" id="S75T2U853">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">    <span class="mxinfo " id="T2:U643"><span class="var type1" id="S24T2U858">mode_dwfix</span> = <span class="mxinfo " id="T2:U645">mode(<span class="mxinfo " id="T1:U646"><span class="var type1" id="S3T1U862">s_max_UKF_dwfix</span>(<span class="mxinfo " id="T9:U648"><span class="var type1" id="S75T2U864">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">    <span class="mxinfo " id="T2:U650"><span class="var type1" id="S28T2U869">var_dwfix</span> = <span class="mxinfo " id="T2:U652">var(<span class="mxinfo " id="T1:U653"><span class="var type1" id="S3T1U873">s_max_UKF_dwfix</span>(<span class="mxinfo " id="T9:U655"><span class="var type1" id="S75T2U875">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">    <span class="comment">%% Get QL value and static detuning value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">    <span class="mxinfo " id="T21:U657"><span class="var type1" id="S109T21U880">y_mC</span> = complex(<span class="mxinfo " id="T21:U659"><span class="var type1" id="S46T1U884">PA</span>.*<span class="mxinfo " id="T21:U661">exp(<span class="mxinfo " id="T21:U662"><span class="mxinfo " id="T21:U663"><span class="mxinfo " id="T21:U664"><span class="mxinfo " id="T22:U665">1i</span>*<span class="var type1" id="S47T1U891">PP</span></span>/180</span>*<span class="mxinfo " id="T2:U667">pi</span></span>)</span></span>)</span>; <span class="comment">% Complex Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">    <span class="mxinfo " id="T21:U668"><span class="var type1" id="S113T21U897">u_mC</span> = complex(<span class="mxinfo " id="T21:U670"><span class="var type1" id="S48T1U901">FA</span>.*<span class="mxinfo " id="T21:U672">exp(<span class="mxinfo " id="T21:U673"><span class="mxinfo " id="T21:U674"><span class="mxinfo " id="T21:U675"><span class="mxinfo " id="T22:U676">1i</span>*<span class="var type1" id="S49T1U908">FP</span></span>/180</span>*<span class="mxinfo " id="T2:U678">pi</span></span>)</span></span>)</span>; <span class="comment">% Complex Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">    <span class="mxinfo " id="T21:U679"><span class="var type1" id="S114T21U914">r_mC</span> = complex(<span class="mxinfo " id="T21:U681"><span class="var type1" id="S50T1U918">RA</span>.*<span class="mxinfo " id="T21:U683">exp(<span class="mxinfo " id="T21:U684"><span class="mxinfo " id="T21:U685"><span class="mxinfo " id="T21:U686"><span class="mxinfo " id="T22:U687">1i</span>*<span class="var type1" id="S51T1U925">RP</span></span>/180</span>*<span class="mxinfo " id="T2:U689">pi</span></span>)</span></span>)</span>; <span class="comment">% Reflected</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">    [<span class="var type1" id="S115T21U932">u_mCal</span>, <span class="var type1" id="S116T21U933">r_mCal</span>] = <span class="fcn" id="F195N7:B935">f_calibrateData</span>(<span class="var type1" id="S113T21U936">u_mC</span>, <span class="var type1" id="S114T21U937">r_mC</span>, <span class="var type1" id="S109T21U938">y_mC</span>, <span class="var type1" id="S54T3U939">cal_coeff</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo " id="T8:U696"><span class="mxinfo " id="T2:U697">mean(<span class="mxinfo " id="T1:U698">abs(<span class="mxinfo " id="T21:U699"><span class="mxinfo " id="T21:U700"><span class="var type1" id="S109T21U950">y_mC</span>(<span class="var type1" id="S78T9U951">Flattop</span>)</span> - (<span class="mxinfo " id="T21:U703"><span class="mxinfo " id="T21:U704"><span class="var type1" id="S115T21U955">u_mCal</span>(<span class="var type1" id="S78T9U956">Flattop</span>)</span> + <span class="mxinfo " id="T21:U707"><span class="var type1" id="S116T21U958">r_mCal</span>(<span class="var type1" id="S78T9U959">Flattop</span>)</span></span>)</span>)</span>)</span> &lt; <span class="mxinfo " id="T2:U710">0.05</span></span> &amp;&amp; <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">            <span class="mxinfo " id="T8:U711"><span class="mxinfo " id="T2:U712">mean(<span class="mxinfo " id="T1:U713">abs(<span class="mxinfo " id="T21:U714"><span class="var type1" id="S115T21U967">u_mCal</span>(<span class="mxinfo " id="T9:U716"><span class="var type1" id="S80T9U969">Decay</span>(<span class="mxinfo " id="T9:U718"><span class="mxinfo " id="T2:U719">25</span>:<span class="mxinfo " id="T2:U720"><span class="mxinfo " id="T2:U721">end</span>-<span class="mxinfo " id="T2:U722">1</span></span></span>)</span>)</span>)</span>)</span> &lt; <span class="mxinfo " id="T2:U723">0.8</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line">        <span class="mxinfo " id="T2:U724"><span class="var type1" id="S43T2U979">calib_check</span>  = <span class="mxinfo " id="T2:U726">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">        <span class="mxinfo " id="T2:U727"><span class="var type1" id="S43T2U984">calib_check</span> = <span class="mxinfo " id="T2:U729">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">    <span class="mxinfo " id="T2:U730"><span class="var type1" id="S38T2U988">QL</span>  = <span class="mxinfo " id="T2:U732">mean(<span class="mxinfo " id="T2:U733"><span class="fcn" id="F1742N10:B992">f_computeQL</span>(<span class="var type1" id="S76T9U993">Rise</span>, <span class="var type1" id="S115T21U994">u_mCal</span>, <span class="var type1" id="S109T21U995">y_mC</span>, <span class="var type1" id="S73T2U996">fs</span>, <span class="var type1" id="S74T2U997">f0</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">    <span class="mxinfo " id="T1:U739"><span class="var type1" id="S120T1U1000">dw</span> = <span class="mxinfo " id="T1:U741"><span class="fcn" id="F1808N11:B1002">f_compute_detuning</span>(<span class="var type1" id="S109T21U1003">y_mC</span>, <span class="var type1" id="S115T21U1004">u_mCal</span>, <span class="var type1" id="S73T2U1005">fs</span>, <span class="var type1" id="S38T2U1006">QL</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">    <span class="mxinfo " id="T1:U746"><span class="var type1" id="S55T1U1009">dwfix</span> = <span class="mxinfo " id="T1:U748"><span class="fcn" id="F1808N11:B1011">f_compute_detuning</span>(<span class="var type1" id="S109T21U1012">y_mC</span>, <span class="var type1" id="S115T21U1013">u_mCal</span>, <span class="var type1" id="S73T2U1014">fs</span>, <span class="var type1" id="S59T2U1015">QL_nom</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">    <span class="comment">%% Detuning Trace Residual Generation + GLRT Evaluation</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo " id="T1:U753"><span class="var type1" id="S122T1U1018">dw_res</span> = <span class="mxinfo " id="T1:U755"><span class="mxinfo " id="T1:U756"><span class="var type1" id="S120T1U1021">dw</span>(<span class="mxinfo " id="T9:U758"><span class="mxinfo " id="T2:U759">45</span>:end</span>,<span class="mxinfo " id="T18:U760">:</span>)</span> - <span class="mxinfo " id="T1:U761"><span class="var type1" id="S55T1U1028">dwfix</span>(<span class="mxinfo " id="T9:U763"><span class="mxinfo " id="T2:U764">45</span>:end</span>,<span class="mxinfo " id="T18:U765">:</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo " id="T1:U766"><span class="var type1" id="S91T1U1036">y</span> = <span class="var type1" id="S122T1U1037">dw_res</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">    <span class="mxinfo " id="T2:U769"><span class="var type1" id="S95T2U1040">N</span>=<span class="mxinfo " id="T2:U771">10</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">    <span class="mxinfo " id="T1:U772">[<span class="var type1" id="S4T1U1045">s_max_dw</span>] = <span class="mxinfo " id="T1:U774"><span class="mxinfo " id="T9:U775"><span class="fcn" id="F1668N6:B1048">f_GLT</span>(<span class="var type1" id="S70T2U1049">Sigma_nom_dw</span>, <span class="mxinfo " id="T9:U777"><span class="var type1" id="S91T1U1051">y</span>.'</span>, <span class="var type1" id="S95T2U1052">N</span>)</span>.'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">    <span class="mxinfo " id="T2:U780"><span class="var type1" id="S10T2U1055">classis_dw</span> = <span class="mxinfo " id="T2:U782">sum(<span class="mxinfo " id="T10:U783"><span class="mxinfo " id="T1:U784"><span class="var type1" id="S4T1U1060">s_max_dw</span>(<span class="mxinfo " id="T9:U786"><span class="var type1" id="S75T2U1062">idxIgn</span>:end</span>)</span> &gt; <span class="mxinfo " id="T2:U788">10.8</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line">    <span class="mxinfo " id="T2:U789"><span class="var type1" id="S14T2U1068">strengthis_dw</span> = <span class="mxinfo " id="T2:U791">mean(<span class="mxinfo " id="T1:U792"><span class="var type1" id="S4T1U1072">s_max_dw</span>(<span class="mxinfo " id="T9:U794"><span class="var type1" id="S75T2U1074">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="mxinfo " id="T2:U796"><span class="var type1" id="S18T2U1079">max_dw</span> = <span class="mxinfo " id="T2:U798">max(<span class="mxinfo " id="T1:U799"><span class="var type1" id="S4T1U1083">s_max_dw</span>(<span class="mxinfo " id="T9:U801"><span class="var type1" id="S75T2U1085">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    <span class="mxinfo " id="T2:U803"><span class="var type1" id="S22T2U1090">median_dw</span> = <span class="mxinfo " id="T2:U805">median(<span class="mxinfo " id="T1:U806"><span class="var type1" id="S4T1U1094">s_max_dw</span>(<span class="mxinfo " id="T9:U808"><span class="var type1" id="S75T2U1096">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line">    <span class="mxinfo " id="T2:U810"><span class="var type1" id="S26T2U1101">mode_dw</span> = <span class="mxinfo " id="T2:U812">mode(<span class="mxinfo " id="T1:U813"><span class="var type1" id="S4T1U1105">s_max_dw</span>(<span class="mxinfo " id="T9:U815"><span class="var type1" id="S75T2U1107">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo " id="T2:U817"><span class="var type1" id="S30T2U1112">var_dw</span> = <span class="mxinfo " id="T2:U819">var(<span class="mxinfo " id="T1:U820"><span class="var type1" id="S4T1U1116">s_max_dw</span>(<span class="mxinfo " id="T9:U822"><span class="var type1" id="S75T2U1118">idxIgn</span>:end</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    <span class="mxinfo " id="T2:U824"><span class="var type1" id="S39T2U1123">dw_stat</span> = <span class="mxinfo " id="T2:U826">mean(<span class="mxinfo " id="T1:U827"><span class="var type1" id="S120T1U1127">dw</span>(<span class="var type1" id="S78T9U1128">Flattop</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="mxinfo " id="T2:U830"><span class="var type1" id="S41T2U1131">SP_P</span> = <span class="mxinfo " id="T2:U832">mean(<span class="mxinfo " id="T1:U833"><span class="var type1" id="S46T1U1135">PA</span>(<span class="var type1" id="S78T9U1136">Flattop</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">    <span class="mxinfo " id="T2:U836"><span class="var type1" id="S40T2U1139">SP_F</span> = <span class="mxinfo " id="T2:U838">mean(<span class="mxinfo " id="T1:U839">abs(<span class="mxinfo " id="T21:U840"><span class="var type1" id="S115T21U1145">u_mCal</span>(<span class="var type1" id="S76T9U1146">Rise</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">    <span class="mxinfo " id="T2:U843"><span class="var type1" id="S123T2U1149">idx_u_mCal_cut</span> = <span class="mxinfo " id="T2:U845">zeros(1,size(<span class="var type1" id="S115T21U1155">u_mCal</span>,2))</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S94T2U1159">ii</span> = <span class="mxinfo " id="T2:U848">1:size(<span class="var type1" id="S115T21U1164">u_mCal</span>,2)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">        <span class="mxinfo " id="T1:U850"><span class="var type1" id="S125T1U1168">idx_u_mCal_off</span> = <span class="mxinfo " id="T1:U852">find(<span class="mxinfo " id="T10:U853"><span class="mxinfo " id="T1:U854">abs(<span class="mxinfo " id="T21:U855"><span class="var type1" id="S115T21U1175">u_mCal</span>(<span class="mxinfo " id="T23:U857">:</span>,<span class="var type1" id="S94T2U1177">ii</span>)</span>)</span>&lt;<span class="mxinfo " id="T2:U859">1.5</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">        <span class="mxinfo " id="T1:U860"><span class="var type1" id="S126T1U1181">idx_u_mCal_cutoff</span> = <span class="mxinfo " id="T1:U862"><span class="var type1" id="S125T1U1183">idx_u_mCal_off</span>(<span class="mxinfo " id="T10:U864"><span class="var type1" id="S125T1U1185">idx_u_mCal_off</span>&gt;<span class="mxinfo " id="T2:U866"><span class="mxinfo " id="T2:U867"><span class="var type1" id="S76T9U1188">Rise</span>(<span class="mxinfo " id="T2:U869">1</span>)</span>+<span class="mxinfo " id="T2:U870">3</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">        <span class="mxinfo " id="T2:U871"><span class="var type1" id="S123T2U1194">idx_u_mCal_cut</span>(1,<span class="var type1" id="S94T2U1196">ii</span>) = <span class="mxinfo " id="T2:U874"><span class="var type1" id="S126T1U1198">idx_u_mCal_cutoff</span>(<span class="mxinfo " id="T2:U876">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line">    <span class="mxinfo " id="T2:U877"><span class="var type1" id="S42T2U1202">PC</span> = <span class="var type1" id="S123T2U1203">idx_u_mCal_cut</span></span>;  <span class="comment">%double(abs(u_mCal(Flattop(end-1))) &lt; 1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line">    <span class="mxinfo " id="T2:U880"><span class="var type1" id="S44T2U1206">dec_hq</span> = <span class="mxinfo " id="T2:U882">abs(<span class="mxinfo " id="T2:U883"><span class="var type1" id="S38T2U1210">QL</span>-<span class="var type1" id="S59T2U1211">QL_nom</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line">    <span class="mxinfo " id="T2:U886"><span class="var type1" id="S45T2U1214">zpth</span> = <span class="mxinfo " id="T2:U888">sum(<span class="mxinfo " id="T10:U889"><span class="mxinfo " id="T1:U890"><span class="var type1" id="S49T1U1219">FP</span>(<span class="mxinfo " id="T9:U892"><span class="mxinfo " id="T2:U893">1420</span>:end</span>)</span>==<span class="mxinfo " id="T2:U894">0</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line">    <span class="mxinfo " id="T1:U895"><span class="var type1" id="S2T1U1228">s_max_UKF</span> = <span class="mxinfo " id="T1:U897">NaN(<span class="mxinfo " id="T2:U898">length(<span class="var type1" id="S46T1U1233">PA</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line">    <span class="mxinfo " id="T1:U900"><span class="var type1" id="S3T1U1237">s_max_UKF_dwfix</span> = <span class="mxinfo " id="T1:U902">NaN(<span class="mxinfo " id="T2:U903">length(<span class="var type1" id="S46T1U1242">PA</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line">    <span class="mxinfo " id="T1:U905"><span class="var type1" id="S4T1U1246">s_max_dw</span> = <span class="mxinfo " id="T1:U907">NaN(<span class="mxinfo " id="T2:U908">length(<span class="mxinfo " id="T1:U909"><span class="var type1" id="S55T1U1252">dwfix</span>(<span class="mxinfo " id="T9:U911"><span class="mxinfo " id="T2:U912">45</span>:end</span>,<span class="mxinfo " id="T18:U913">:</span>)</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line">    <span class="mxinfo " id="T1:U914"><span class="var type1" id="S5T1U1261">s_max_PS1</span> = <span class="mxinfo " id="T1:U916">NaN(<span class="mxinfo " id="T2:U917">length(<span class="var type1" id="S71T1U1266">r_PS1_nom</span>)</span>, 1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line">    <span class="mxinfo " id="T1:U919"><span class="var type1" id="S6T1U1270">res_PS2</span> = <span class="mxinfo " id="T1:U921">NaN(<span class="mxinfo " id="T2:U922">length(<span class="var type1" id="S46T1U1275">PA</span>)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo " id="T2:U924"><span class="var type1" id="S7T2U1279">classis_UKF</span> = <span class="mxinfo " id="T2:U926">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line">    <span class="mxinfo " id="T2:U927"><span class="var type1" id="S9T2U1284">classis_PS</span> = <span class="mxinfo " id="T2:U929">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line">    <span class="mxinfo " id="T2:U930"><span class="var type1" id="S10T2U1289">classis_dw</span> = <span class="mxinfo " id="T2:U932">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line">    <span class="mxinfo " id="T2:U933"><span class="var type1" id="S8T2U1294">classis_dwfix</span> = <span class="mxinfo " id="T2:U935">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    <span class="mxinfo " id="T2:U936"><span class="var type1" id="S11T2U1299">strengthis_UKF</span> = <span class="mxinfo " id="T2:U938">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">    <span class="mxinfo " id="T2:U939"><span class="var type1" id="S13T2U1304">strengthis_PS</span> = <span class="mxinfo " id="T2:U941">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">    <span class="mxinfo " id="T2:U942"><span class="var type1" id="S14T2U1309">strengthis_dw</span> = <span class="mxinfo " id="T2:U944">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line">    <span class="mxinfo " id="T2:U945"><span class="var type1" id="S12T2U1314">strengthis_dwfix</span> = <span class="mxinfo " id="T2:U947">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line">    <span class="mxinfo " id="T2:U948"><span class="var type1" id="S15T2U1319">max_UKF</span> = <span class="mxinfo " id="T2:U950">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line">    <span class="mxinfo " id="T2:U951"><span class="var type1" id="S17T2U1324">max_PS</span> = <span class="mxinfo " id="T2:U953">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line">    <span class="mxinfo " id="T2:U954"><span class="var type1" id="S18T2U1329">max_dw</span> = <span class="mxinfo " id="T2:U956">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line">    <span class="mxinfo " id="T2:U957"><span class="var type1" id="S16T2U1334">max_dwfix</span> = <span class="mxinfo " id="T2:U959">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">    <span class="mxinfo " id="T2:U960"><span class="var type1" id="S19T2U1339">median_UKF</span> = <span class="mxinfo " id="T2:U962">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line">    <span class="mxinfo " id="T2:U963"><span class="var type1" id="S21T2U1344">median_PS</span> = <span class="mxinfo " id="T2:U965">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line">    <span class="mxinfo " id="T2:U966"><span class="var type1" id="S22T2U1349">median_dw</span> = <span class="mxinfo " id="T2:U968">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">    <span class="mxinfo " id="T2:U969"><span class="var type1" id="S20T2U1354">median_dwfix</span> = <span class="mxinfo " id="T2:U971">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">    <span class="mxinfo " id="T2:U972"><span class="var type1" id="S23T2U1359">mode_UKF</span> = <span class="mxinfo " id="T2:U974">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line">    <span class="mxinfo " id="T2:U975"><span class="var type1" id="S24T2U1364">mode_dwfix</span>= <span class="mxinfo " id="T2:U977">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,184" id="srcline184">184</a></span><span class="line">    <span class="mxinfo " id="T2:U978"><span class="var type1" id="S25T2U1369">mode_PS</span>= <span class="mxinfo " id="T2:U980">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,185" id="srcline185">185</a></span><span class="line">    <span class="mxinfo " id="T2:U981"><span class="var type1" id="S26T2U1374">mode_dw</span>= <span class="mxinfo " id="T2:U983">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,186" id="srcline186">186</a></span><span class="line">    <span class="mxinfo " id="T2:U984"><span class="var type1" id="S27T2U1379">var_UKF</span>= <span class="mxinfo " id="T2:U986">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,187" id="srcline187">187</a></span><span class="line">    <span class="mxinfo " id="T2:U987"><span class="var type1" id="S28T2U1384">var_dwfix</span>= <span class="mxinfo " id="T2:U989">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,188" id="srcline188">188</a></span><span class="line">    <span class="mxinfo " id="T2:U990"><span class="var type1" id="S29T2U1389">var_PS</span>= <span class="mxinfo " id="T2:U992">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,189" id="srcline189">189</a></span><span class="line">    <span class="mxinfo " id="T2:U993"><span class="var type1" id="S30T2U1394">var_dw</span>= <span class="mxinfo " id="T2:U995">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,190" id="srcline190">190</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,191" id="srcline191">191</a></span><span class="line">    <span class="mxinfo " id="T2:U996"><span class="var type1" id="S31T2U1399">rm_I</span>= <span class="mxinfo " id="T2:U998">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,192" id="srcline192">192</a></span><span class="line">    <span class="mxinfo " id="T2:U999"><span class="var type1" id="S32T2U1404">rm_Q</span>= <span class="mxinfo " id="T2:U1001">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,193" id="srcline193">193</a></span><span class="line">    <span class="mxinfo " id="T2:U1002"><span class="var type1" id="S33T2U1409">rm_I_dwfix</span>= <span class="mxinfo " id="T2:U1004">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,194" id="srcline194">194</a></span><span class="line">    <span class="mxinfo " id="T2:U1005"><span class="var type1" id="S34T2U1414">rm_Q_dwfix</span>= <span class="mxinfo " id="T2:U1007">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,195" id="srcline195">195</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,196" id="srcline196">196</a></span><span class="line">    <span class="mxinfo " id="T2:U1008"><span class="var type1" id="S35T2U1419">rvar_1</span>= <span class="mxinfo " id="T2:U1010">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,197" id="srcline197">197</a></span><span class="line">    <span class="mxinfo " id="T2:U1011"><span class="var type1" id="S36T2U1424">rvar_2</span>= <span class="mxinfo " id="T2:U1013">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,198" id="srcline198">198</a></span><span class="line">    <span class="mxinfo " id="T2:U1014"><span class="var type1" id="S37T2U1429">rvar_3</span>= <span class="mxinfo " id="T2:U1016">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,199" id="srcline199">199</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,200" id="srcline200">200</a></span><span class="line">    <span class="mxinfo " id="T2:U1017"><span class="var type1" id="S38T2U1434">QL</span> = <span class="mxinfo " id="T2:U1019">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,201" id="srcline201">201</a></span><span class="line">    <span class="mxinfo " id="T2:U1020"><span class="var type1" id="S39T2U1439">dw_stat</span> = <span class="mxinfo " id="T2:U1022">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,202" id="srcline202">202</a></span><span class="line">    <span class="mxinfo " id="T2:U1023"><span class="var type1" id="S40T2U1444">SP_F</span> = <span class="mxinfo " id="T2:U1025">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,203" id="srcline203">203</a></span><span class="line">    <span class="mxinfo " id="T2:U1026"><span class="var type1" id="S41T2U1449">SP_P</span> = <span class="mxinfo " id="T2:U1028">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,204" id="srcline204">204</a></span><span class="line">    <span class="mxinfo " id="T2:U1029"><span class="var type1" id="S42T2U1454">PC</span> = <span class="mxinfo " id="T2:U1031">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,205" id="srcline205">205</a></span><span class="line">    <span class="mxinfo " id="T2:U1032"><span class="var type1" id="S43T2U1459">calib_check</span> = <span class="mxinfo " id="T2:U1034">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,206" id="srcline206">206</a></span><span class="line">    <span class="mxinfo " id="T2:U1035"><span class="var type1" id="S44T2U1464">dec_hq</span> = <span class="mxinfo " id="T2:U1037">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,207" id="srcline207">207</a></span><span class="line">    <span class="mxinfo " id="T2:U1038"><span class="var type1" id="S45T2U1469">zpth</span> = <span class="mxinfo " id="T2:U1040">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,208" id="srcline208">208</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,209" id="srcline209">209</a></span><span class="line"><span class="comment">% figure(14),</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,210" id="srcline210">210</a></span><span class="line"><span class="comment">% hold on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,211" id="srcline211">211</a></span><span class="line"><span class="comment">% plot(dw,'')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,212" id="srcline212">212</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,213" id="srcline213">213</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,214" id="srcline214">214</a></span><span class="line"><span class="comment">% figure(21)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,215" id="srcline215">215</a></span><span class="line"><span class="comment">% hold on</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,216" id="srcline216">216</a></span><span class="line"><span class="comment">% plot(res_full_mean(1,:),'k')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,217" id="srcline217">217</a></span><span class="line"><span class="comment">% plot(res_full_mean(2,:),'k')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,218" id="srcline218">218</a></span><span class="line"><span class="comment">% xlabel('Samples')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,219" id="srcline219">219</a></span><span class="line"><span class="comment">% ylabel('Residual')</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,220" id="srcline220">220</a></span><span class="line"><span class="comment">% ylim([-0.05,0.05])</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,221" id="srcline221">221</a></span><span class="line"><span class="comment">%[FIT, y_mC_hat]=f_cavitySystemSimulatior(y_mC, u_mC, f0, fs, sys_hat, QL, plt, u3)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,222" id="srcline222">222</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,223" id="srcline223">223</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,224" id="srcline224">224</a></span><span class="line"></span></span>
</pre>
</body>
</html>
