<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="101,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T3U3">calCoeff</span>] = f_get_calCoeff_codegen(<span class="var type1" id="S3T4U6">Probe_Ampl</span>,<span class="var type1" id="S4T4U7">Probe_Phase</span>, <span class="var type1" id="S5T4U8">Forw_Ampl</span>, <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,2" id="srcline2"> 2</a></span><span class="line">    <span class="var type1" id="S6T4U9">Forw_Phase</span>, <span class="var type1" id="S7T4U10">Refl_Ampl</span>, <span class="var type1" id="S8T4U11">Refl_Probe</span>, <span class="var type1" id="S9T5U12">DELAY</span>, <span class="var type1" id="S10T5U13">FILLING</span>, <span class="var type1" id="S11T5U14">FLATTOP</span>, <span class="var type1" id="S12T5U15">FS</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="101,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% claCoeff = f_get_calCoeff returns a 4 dimensional vector containing the</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,4" id="srcline4"> 4</a></span><span class="line"><span class="comment">% coefficients needed for the calibration of the forward and reflected</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% signals with respect to the probe. To calibrate a new set of data from</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,6" id="srcline6"> 6</a></span><span class="line"><span class="comment">% the same cavity use f_calibrate().</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">% Input Parameters:</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,8" id="srcline8"> 8</a></span><span class="line"><span class="comment">% Probe_Ampl: Amplitude of Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">% Probe_Phase: Phase of Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,10" id="srcline10">10</a></span><span class="line"><span class="comment">% Forw_Ampl: Amplitude of Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,11" id="srcline11">11</a></span><span class="line"><span class="comment">% Forw_Phase: Phase of Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,12" id="srcline12">12</a></span><span class="line"><span class="comment">% Refl_Ampl: Amplitude of Reflected measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,13" id="srcline13">13</a></span><span class="line"><span class="comment">% Refl_Probe: Phase of Reflected measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,14" id="srcline14">14</a></span><span class="line"><span class="comment">% DECAY_TIM: Array containing the sample numbers that correspond to the</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,15" id="srcline15">15</a></span><span class="line"><span class="comment">% duration of the decay time.</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,16" id="srcline16">16</a></span><span class="line"><span class="comment">%% free parameters<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,17" id="srcline17">17</a></span><span class="line"><span class="comment">% #codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T5:U12"><span class="var type1" id="S13T5U18">fs</span> = <span class="mxinfo " id="T5:U14"><span class="var type1" id="S12T5U20">FS</span>*<span class="mxinfo " id="T5:U16">1e6</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,19" id="srcline19">19</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T7:U17"><span class="var type1" id="S13T5U25">fs</span> ==<span class="mxinfo " id="T5:U19">1e6</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo " id="T21:U20"><span class="var type1" id="S14T21U29">Rise</span> = <span class="mxinfo " id="T21:U22"><span class="mxinfo " id="T5:U23">round(<span class="mxinfo " id="T5:U24"><span class="mxinfo " id="T5:U25"><span class="var type1" id="S9T5U35">DELAY</span> * <span class="var type1" id="S13T5U36">fs</span></span> *<span class="mxinfo " id="T5:U28">1e-6</span></span>)</span>:<span class="mxinfo " id="T5:U29">round(<span class="mxinfo " id="T5:U30"><span class="mxinfo " id="T5:U31"><span class="mxinfo " id="T5:U32"><span class="var type1" id="S9T5U43">DELAY</span> * <span class="var type1" id="S13T5U44">fs</span></span>*<span class="mxinfo " id="T5:U35">1e-6</span></span>+ <span class="mxinfo " id="T5:U36"><span class="mxinfo " id="T5:U37"><span class="var type1" id="S10T5U48">FILLING</span>*<span class="var type1" id="S13T5U49">fs</span></span>*<span class="mxinfo " id="T5:U40">1e-6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,21" id="srcline21">21</a></span><span class="line">    <span class="mxinfo " id="T21:U41"><span class="var type1" id="S16T21U53">Flattop</span> = <span class="mxinfo " id="T21:U43"><span class="mxinfo " id="T5:U44"><span class="mxinfo " id="T5:U45"><span class="var type1" id="S14T21U57">Rise</span>(<span class="mxinfo " id="T5:U47">end</span>)</span>+<span class="mxinfo " id="T5:U48">1</span></span> : <span class="mxinfo " id="T5:U49"><span class="mxinfo " id="T5:U50"><span class="mxinfo " id="T5:U51"><span class="var type1" id="S14T21U64">Rise</span>(<span class="mxinfo " id="T5:U53">end</span>)</span>+<span class="mxinfo " id="T5:U54">1</span></span>+<span class="mxinfo " id="T5:U55">round(<span class="mxinfo " id="T5:U56"><span class="mxinfo " id="T5:U57"><span class="var type1" id="S11T5U72">FLATTOP</span>*<span class="var type1" id="S13T5U73">fs</span></span>*<span class="mxinfo " id="T5:U60">1e-6</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,22" id="srcline22">22</a></span><span class="line">    <span class="mxinfo " id="T21:U61"><span class="var type1" id="S18T21U77">Decay</span> = <span class="mxinfo " id="T21:U63"><span class="mxinfo " id="T5:U64"><span class="mxinfo " id="T5:U65"><span class="var type1" id="S16T21U81">Flattop</span>(<span class="mxinfo " id="T5:U67">end</span>)</span>+<span class="mxinfo " id="T5:U68">1</span></span> : round(2^(14)/9+1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,23" id="srcline23">23</a></span><span class="line">    <span class="mxinfo " id="T21:U69"><span class="var type1" id="S19T21U97">DECAY_TIME</span> = <span class="mxinfo " id="T21:U71"><span class="mxinfo " id="T5:U72"><span class="mxinfo " id="T5:U73"><span class="var type1" id="S18T21U101">Decay</span>(<span class="mxinfo " id="T5:U75">1</span>)</span>+<span class="mxinfo " id="T5:U76">round(<span class="mxinfo " id="T5:U77">3000/9</span>)</span></span>:<span class="mxinfo " id="T5:U78"><span class="var type1" id="S18T21U109">Decay</span>(<span class="mxinfo " id="T5:U80">end</span>)</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="101,24" id="srcline24">24</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,25" id="srcline25">25</a></span><span class="line">    <span class="mxinfo " id="T21:U81"><span class="var type1" id="S14T21U115">Rise</span> = <span class="mxinfo " id="T21:U83"><span class="mxinfo " id="T5:U84">round(<span class="mxinfo " id="T5:U85"><span class="mxinfo " id="T5:U86"><span class="var type1" id="S9T5U121">DELAY</span> * <span class="var type1" id="S13T5U122">fs</span></span> *<span class="mxinfo " id="T5:U89">1e-6</span></span>)</span>:<span class="mxinfo " id="T5:U90">round(<span class="mxinfo " id="T5:U91"><span class="mxinfo " id="T5:U92"><span class="mxinfo " id="T5:U93"><span class="var type1" id="S9T5U129">DELAY</span> * <span class="var type1" id="S13T5U130">fs</span></span>*<span class="mxinfo " id="T5:U96">1e-6</span></span>+ <span class="mxinfo " id="T5:U97"><span class="mxinfo " id="T5:U98"><span class="var type1" id="S10T5U134">FILLING</span>*<span class="var type1" id="S13T5U135">fs</span></span>*<span class="mxinfo " id="T5:U101">1e-6</span></span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,26" id="srcline26">26</a></span><span class="line">    <span class="mxinfo " id="T21:U102"><span class="var type1" id="S16T21U139">Flattop</span> = <span class="mxinfo " id="T21:U104"><span class="mxinfo " id="T5:U105"><span class="mxinfo " id="T5:U106"><span class="var type1" id="S14T21U143">Rise</span>(<span class="mxinfo " id="T5:U108">end</span>)</span>+<span class="mxinfo " id="T5:U109">1</span></span> : <span class="mxinfo " id="T5:U110"><span class="mxinfo " id="T5:U111"><span class="mxinfo " id="T5:U112"><span class="var type1" id="S14T21U150">Rise</span>(<span class="mxinfo " id="T5:U114">end</span>)</span>+<span class="mxinfo " id="T5:U115">1</span></span>+<span class="mxinfo " id="T5:U116">round(<span class="mxinfo " id="T5:U117"><span class="mxinfo " id="T5:U118"><span class="var type1" id="S11T5U158">FLATTOP</span>*<span class="var type1" id="S13T5U159">fs</span></span>*<span class="mxinfo " id="T5:U121">1e-6</span></span>)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,27" id="srcline27">27</a></span><span class="line">    <span class="mxinfo " id="T21:U122"><span class="var type1" id="S18T21U163">Decay</span> = <span class="mxinfo " id="T21:U124"><span class="mxinfo " id="T5:U125"><span class="mxinfo " id="T5:U126"><span class="var type1" id="S16T21U167">Flattop</span>(<span class="mxinfo " id="T5:U128">end</span>)</span>+<span class="mxinfo " id="T5:U129">1</span></span> : 2^(14)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,28" id="srcline28">28</a></span><span class="line">    <span class="mxinfo " id="T21:U130"><span class="var type1" id="S19T21U177">DECAY_TIME</span> = <span class="mxinfo " id="T21:U132"><span class="mxinfo " id="T5:U133"><span class="mxinfo " id="T5:U134"><span class="var type1" id="S18T21U181">Decay</span>(<span class="mxinfo " id="T5:U136">1</span>)</span>+<span class="mxinfo " id="T5:U137">3000</span></span>:<span class="mxinfo " id="T5:U138"><span class="var type1" id="S18T21U185">Decay</span>(<span class="mxinfo " id="T5:U140">end</span>)</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="101,29" id="srcline29">29</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,30" id="srcline30">30</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,31" id="srcline31">31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,32" id="srcline32">32</a></span><span class="line"><span class="mxinfo " id="T29:U141"><span class="var type1" id="S20T29U190">y_mC</span> = <span class="mxinfo " id="T29:U143"><span class="var type1" id="S3T4U192">Probe_Ampl</span>.*<span class="mxinfo " id="T29:U145">exp(<span class="mxinfo " id="T29:U146"><span class="mxinfo " id="T29:U147"><span class="mxinfo " id="T29:U148"><span class="mxinfo " id="T28:U149">1i</span>*<span class="var type1" id="S4T4U199">Probe_Phase</span></span>/180</span>*<span class="mxinfo " id="T5:U151">pi</span></span>)</span></span></span>; <span class="comment">% Complex Probe measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo " id="T29:U152"><span class="var type1" id="S23T29U205">u_mC</span> = <span class="mxinfo " id="T29:U154"><span class="var type1" id="S5T4U207">Forw_Ampl</span>.*<span class="mxinfo " id="T29:U156">exp(<span class="mxinfo " id="T29:U157"><span class="mxinfo " id="T29:U158"><span class="mxinfo " id="T29:U159"><span class="mxinfo " id="T28:U160">1i</span>*<span class="var type1" id="S6T4U214">Forw_Phase</span></span>/180</span>*<span class="mxinfo " id="T5:U162">pi</span></span>)</span></span></span>; <span class="comment">% Complex Forward measurement</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T29:U163"><span class="var type1" id="S24T29U220">r_mC</span> = <span class="mxinfo " id="T29:U165"><span class="var type1" id="S7T4U222">Refl_Ampl</span>.*<span class="mxinfo " id="T29:U167">exp(<span class="mxinfo " id="T29:U168"><span class="mxinfo " id="T29:U169"><span class="mxinfo " id="T29:U170"><span class="mxinfo " id="T28:U171">1i</span>*<span class="var type1" id="S8T4U229">Refl_Probe</span></span>/180</span>*<span class="mxinfo " id="T5:U173">pi</span></span>)</span></span></span>; <span class="comment">% Reflected</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T3:U174"><span class="var type1" id="S2T3U235">calCoeff</span> = <span class="mxinfo " id="T3:U176"><span class="mxinfo " id="T6:U177">zeros(<span class="mxinfo " id="T5:U178">4</span>,1)</span>+<span class="mxinfo " id="T3:U179"><span class="mxinfo " id="T28:U180">1i</span>*<span class="mxinfo " id="T6:U181">zeros(<span class="mxinfo " id="T5:U182">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,36" id="srcline36">36</a></span><span class="line"><span class="mxinfo " id="T3:U183"><span class="var type1" id="S26T3U249">calCoeff0</span> = <span class="mxinfo " id="T3:U185"><span class="mxinfo " id="T6:U186">zeros(<span class="mxinfo " id="T5:U187">4</span>,1)</span>+<span class="mxinfo " id="T3:U188"><span class="mxinfo " id="T28:U189">1i</span>*<span class="mxinfo " id="T6:U190">zeros(<span class="mxinfo " id="T5:U191">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,37" id="srcline37">37</a></span><span class="line"><span class="mxinfo " id="T3:U192"><span class="var type1" id="S27T3U263">calCoeff1</span> = <span class="mxinfo " id="T3:U194"><span class="mxinfo " id="T6:U195">zeros(<span class="mxinfo " id="T5:U196">4</span>,1)</span>+<span class="mxinfo " id="T3:U197"><span class="mxinfo " id="T28:U198">1i</span>*<span class="mxinfo " id="T6:U199">zeros(<span class="mxinfo " id="T5:U200">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,38" id="srcline38">38</a></span><span class="line"><span class="mxinfo " id="T3:U201"><span class="var type1" id="S28T3U277">calCoeff2</span> = <span class="mxinfo " id="T3:U203">zeros(<span class="mxinfo " id="T5:U204">4</span>,1)+1i*zeros(<span class="mxinfo " id="T5:U205">4</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,39" id="srcline39">39</a></span><span class="line"><span class="mxinfo " id="T3:U206"><span class="var type1" id="S29T3U291">calCoeff3</span> = <span class="mxinfo " id="T3:U208"><span class="mxinfo " id="T6:U209">zeros(<span class="mxinfo " id="T5:U210">4</span>,1)</span>+<span class="mxinfo " id="T3:U211"><span class="mxinfo " id="T28:U212">1i</span>*<span class="mxinfo " id="T6:U213">zeros(<span class="mxinfo " id="T5:U214">4</span>,1)</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,40" id="srcline40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,41" id="srcline41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,42" id="srcline42">42</a></span><span class="line"><span class="mxinfo " id="T29:U215"><span class="var type1" id="S30T29U305">a1</span> = <span class="var type1" id="S23T29U306">u_mC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,43" id="srcline43">43</a></span><span class="line"><span class="mxinfo " id="T29:U218"><span class="var type1" id="S31T29U309">a2</span> = <span class="var type1" id="S24T29U310">r_mC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,44" id="srcline44">44</a></span><span class="line"><span class="mxinfo " id="T29:U221"><span class="var type1" id="S32T29U313">a3</span> = <span class="mxinfo " id="T29:U223"><span class="var type1" id="S23T29U315">u_mC</span>(<span class="var type1" id="S19T21U316">DECAY_TIME</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,45" id="srcline45">45</a></span><span class="line"><span class="mxinfo " id="T29:U226"><span class="var type1" id="S33T29U319">a4</span> = <span class="mxinfo " id="T29:U228"><span class="var type1" id="S24T29U321">r_mC</span>(<span class="var type1" id="S19T21U322">DECAY_TIME</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,46" id="srcline46">46</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,47" id="srcline47">47</a></span><span class="line"><span class="mxinfo " id="T29:U231"><span class="var type1" id="S34T29U325">b1</span> = <span class="var type1" id="S20T29U326">y_mC</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,48" id="srcline48">48</a></span><span class="line"><span class="mxinfo " id="T29:U234"><span class="var type1" id="S35T29U329">b2</span> = <span class="mxinfo " id="T29:U236"><span class="var type1" id="S20T29U331">y_mC</span>(<span class="var type1" id="S19T21U332">DECAY_TIME</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,49" id="srcline49">49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,50" id="srcline50">50</a></span><span class="line"><span class="mxinfo " id="T4:U239"><span class="var type1" id="S36T4U335">zb</span> = <span class="mxinfo " id="T4:U241">zeros(<span class="mxinfo " id="T5:U242">size(<span class="var type1" id="S35T29U340">b2</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,51" id="srcline51">51</a></span><span class="line"><span class="mxinfo " id="T4:U244"><span class="var type1" id="S38T4U343">za</span> = <span class="mxinfo " id="T4:U246">zeros(<span class="mxinfo " id="T5:U247">size(<span class="var type1" id="S32T29U348">a3</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,52" id="srcline52">52</a></span><span class="line"><span class="comment">%za1= zeros(size(a1));</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,53" id="srcline53">53</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,54" id="srcline54">54</a></span><span class="line"><span class="mxinfo " id="T49:U249"><span class="var type1" id="S39T49U351">xystar</span> = <span class="mxinfo " id="T49:U251"><span class="mxinfo " id="T39:U252">[<span class="var type1" id="S30T29U355">a1</span> <span class="var type1" id="S31T29U356">a2</span>]</span>\<span class="var type1" id="S34T29U357">b1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,55" id="srcline55">55</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,56" id="srcline56">56</a></span><span class="line"><span class="mxinfo " id="T28:U256"><span class="var type1" id="S40T28U360">xstar</span> = <span class="mxinfo " id="T28:U258"><span class="var type1" id="S39T49U362">xystar</span>(<span class="mxinfo " id="T5:U260">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,57" id="srcline57">57</a></span><span class="line"><span class="mxinfo " id="T28:U261"><span class="var type1" id="S41T28U366">ystar</span> = <span class="mxinfo " id="T28:U263"><span class="var type1" id="S39T49U368">xystar</span>(<span class="mxinfo " id="T5:U265">2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,58" id="srcline58">58</a></span><span class="line"><span class="comment">% estimate cross couplings next<span class="keyword">...</span><span class="comment">.</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,59" id="srcline59">59</a></span><span class="line"><span class="comment">% uses method of least squares<span class="keyword">...</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="101,60" id="srcline60">60</a></span><span class="line"><span class="mxinfo " id="T5:U266"><span class="var type1" id="S42T5U372">Wb</span> = <span class="mxinfo " id="T5:U268">0.10</span></span>; <span class="comment">% tunig factor to adjust f1/2 within pulse and during decay (Fig 21, red == yellow line)</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,61" id="srcline61">61</a></span><span class="line"><span class="mxinfo " id="T5:U269"><span class="var type1" id="S43T5U376">Wc</span> = (<span class="var type1" id="S42T5U378">Wb</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,62" id="srcline62">62</a></span><span class="line"><span class="mxinfo " id="T29:U272"><span class="var type1" id="S44T29U381">Bold</span> = <span class="mxinfo " id="T29:U274">[ <span class="var type1" id="S36T4U384">zb</span> ; <span class="var type1" id="S34T29U386">b1</span> ; <span class="var type1" id="S35T29U388">b2</span> ; <span class="var type1" id="S40T28U390">xstar</span> ; <span class="var type1" id="S41T28U392">ystar</span> ; <span class="var type1" id="S41T28U394">ystar</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,63" id="srcline63">63</a></span><span class="line"><span class="mxinfo " id="T59:U281"><span class="var type1" id="S45T59U397">Aold</span> = <span class="mxinfo " id="T59:U283">[<span class="mxinfo " id="T59:U284"><span class="var type1" id="S32T29U400">a3</span>,<span class="var type1" id="S33T29U401">a4</span>,<span class="var type1" id="S38T4U402">za</span>,<span class="var type1" id="S38T4U403">za</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,64" id="srcline64">64</a></span><span class="line">    <span class="mxinfo " id="T59:U289"><span class="var type1" id="S30T29U405">a1</span>,<span class="var type1" id="S31T29U406">a2</span>,<span class="var type1" id="S30T29U407">a1</span>,<span class="var type1" id="S31T29U408">a2</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,65" id="srcline65">65</a></span><span class="line">    <span class="mxinfo " id="T59:U294"><span class="var type1" id="S38T4U410">za</span>,<span class="var type1" id="S38T4U411">za</span>,<span class="var type1" id="S32T29U412">a3</span>,<span class="var type1" id="S33T29U413">a4</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,66" id="srcline66">66</a></span><span class="line">    <span class="mxinfo " id="T70:U299"><span class="mxinfo " id="T5:U300">1</span> <span class="mxinfo " id="T5:U301">0</span> <span class="var type1" id="S43T5U417">Wc</span> <span class="mxinfo " id="T5:U303">0</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,67" id="srcline67">67</a></span><span class="line">    <span class="mxinfo " id="T70:U304"><span class="mxinfo " id="T5:U305">0</span> <span class="var type1" id="S42T5U421">Wb</span> <span class="mxinfo " id="T5:U307">0</span> <span class="mxinfo " id="T5:U308">1</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,68" id="srcline68">68</a></span><span class="line">    <span class="mxinfo " id="T70:U309"><span class="var type1" id="S43T5U425">Wc</span> <span class="mxinfo " id="T5:U311">0</span> <span class="mxinfo " id="T5:U312">0</span> <span class="mxinfo " id="T5:U313">1</span></span>;<span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,69" id="srcline69">69</a></span><span class="line">    ]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,70" id="srcline70">70</a></span><span class="line"><span class="comment">% calCoeff0(:,1) = (Aold.'*Aold)^-1*Aold.'*Bold;%mldivide(Aold,Bold); </span></span></span>
<span class="srcline"><span class="lineno"><a href="101,71" id="srcline71">71</a></span><span class="line"><span class="comment">% calCoeff1(:,1) = inv(Aold.'*Aold)*Aold.'*Bold;%mldivide(Aold,Bold); </span></span></span>
<span class="srcline"><span class="lineno"><a href="101,72" id="srcline72">72</a></span><span class="line"><span class="mxinfo " id="T3:U314"><span class="mxinfo " id="T3:U315"><span class="var type1" id="S28T3U432">calCoeff2</span>(<span class="mxinfo " id="T71:U317">:</span>,<span class="mxinfo " id="T18:U318">1</span>)</span> = <span class="mxinfo " id="T3:U319"><span class="var type1" id="S45T59U436">Aold</span>\<span class="var type1" id="S44T29U437">Bold</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,73" id="srcline73">73</a></span><span class="line"><span class="comment">% calCoeff3(:,1) = mldivide(Aold,Bold);</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,74" id="srcline74">74</a></span><span class="line"><span class="mxinfo " id="T3:U322"><span class="var type1" id="S2T3U440">calCoeff</span> = <span class="var type1" id="S28T3U441">calCoeff2</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="101,75" id="srcline75">75</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="101,76" id="srcline76">76</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="101,77" id="srcline77">77</a></span><span class="line"></span></span>
</pre>
</body>
</html>
